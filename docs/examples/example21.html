<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lanczos module: finite-temperature calculations &mdash; QuSpin 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../static/css/sphinx_rtd_size.css?v=f26ae176" />
      <link rel="stylesheet" type="text/css" href="../static/css/py_class_property_fix.css?v=faf79ccd" />

  
  <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../static/jquery.js?v=5d32c60e"></script>
        <script src="../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../static/documentation_options.js?v=292eb321"></script>
        <script src="../static/doctools.js?v=9a2dae69"></script>
        <script src="../static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            QuSpin
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">New Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../new_features.html">Highlights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../new_features.html#most-recent-changes-features">Most recent changes &amp; features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">QuSpin (public API)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basis.html">Basis module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.basis</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operators.html">Operators module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.operators</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.tools</span></code>)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation &amp; Use</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html#basics-of-command-line-use">Basics of command line use</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../example_scripts.html">Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter_notebooks.html">Jupyter notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/parallelization.html">Parallel computing support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/user_basis.html"><cite>user_basis</cite> tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bugs &amp; Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute/report_a_bug.html">Report a bug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/ask_a_question.html">Ask a question</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuSpin</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Lanczos module: finite-temperature calculations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../sources/examples/example21.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style> .red {color:#ff0000; font-weight:bold; font-style:italic; } </style>
<style> .green {color:#00b200; font-weight:bold; font-style:italic; } </style>
<style> .magenta {color:#FF33F3; font-weight:bold; font-style:italic; } </style>
<style> .orange {color:#FE8E02; font-weight:bold; font-style:italic; } </style><section id="lanczos-module-finite-temperature-calculations">
<span id="example21-label"></span><h1>Lanczos module: finite-temperature calculations<a class="headerlink" href="#lanczos-module-finite-temperature-calculations" title="Link to this heading"></a></h1>
<p>Here we use the transverse-field Ising chain with periodic boundary conditions as an example of how to use QuSpin’s Lanczos module to perform finite-temperature calculations.</p>
<p>We consider the transverse-field Ising model, governed by the Hamiltonian:</p>
<div class="math notranslate nohighlight">
\[H(s) = -s\sum_{i=0}^{L-1} \sigma_i^z\sigma_{i+1}^z - (1-s)\sum_{i=0}^{L-1} \sigma_i^x\]</div>
<p>with periodic boundary conditions. This system is not ordered at finite temperature and, therefore, we expect to see a paramagnetic phase for any finite temperature. We are interested in computing the finite-temperature expectation value of the squared magnetization:</p>
<div class="math notranslate nohighlight">
\[\langle M^2 \rangle_\beta = \frac{Tr\left(e^{-\beta H/2} M^2 e^{-\beta H/2}\right)}{Tr\left(e^{-\beta H} \right)},\qquad M = \frac{1}{L}\sum_{i=0}^{L-1}\sigma^z_j,\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is the inverse temperature.</p>
<p>The example script below demonstrates the use of both the finite-temperature (<cite>FTLM_static_iteration</cite>) and low-temperature (<cite>LTLM_static_iteration</cite>) Lanczos methods, which gives the user the opportunity to compare the approximate methods at high and low temperatures. Following the discussion under <cite>quspin.tools.lanczos.LTLM_static_iteration</cite> and <cite>quspin.tools.lanczos.FTLM_static_iteration</cite>, we make use of the approximation:</p>
<div class="math notranslate nohighlight">
\[\langle O\rangle_\beta \approx \frac{\overline{\langle O\rangle_r}}{\overline{\langle I\rangle_r}},\]</div>
<p>where the notation <span class="math notranslate nohighlight">\(\overline{\;\cdot\;}\)</span> denotes the average over randomly drawn states <span class="math notranslate nohighlight">\(|r\rangle\)</span>, <span class="math notranslate nohighlight">\(\langle O\rangle_r=\langle r| e^{-\beta H/2} O e^{-\beta H/2}|r\rangle\)</span>, and <span class="math notranslate nohighlight">\(I\)</span> is the identity operator.</p>
<p>The first part of the script below define various helper functions and classes that are useful for the calculation. The class <cite>lanczos_wrapper</cite> is a simple class that has all the necessary attributes to calculate the Lanczos basis. The idea here is that we would like to calculate the Lanczos basis for a particular value of the parameter <span class="math notranslate nohighlight">\(s\)</span> without having to calculate the Hamiltonian at that fixed value every time. This calculation is accomplished by using quspin’s <cite>quantum_operator</cite> class combined with the wrapper class: the quantum operator stores both the Ising and the transverse-field Hamiltonians as two separate terms. Then, the wrapper class provides an interface that calls the <cite>dot</cite> method of the quantum operator with the parameters specified, which is required by quspin’s Lanczos methods.</p>
<p>To apply finite-temperature Lanczos methods, we need to average over random states. The loop in the code below is where this calculation for random state vectors occurs. First. a random vector is generated. Then, using that vector, the Lanczos basis is created. With that Lanczos basis, the calculation of the FTLM and LTLM is performed, and we store the results in a list. Finally, the results are averaged, using the bootstrap helper function to calculate the error bars. The results are plotted and compared against exact resultsobtained using exact diagonalization.</p>
</section>
<section id="script">
<h1>Script<a class="headerlink" href="#script" title="Link to this heading"></a></h1>
<p><a class="reference download internal" download="" href="../downloads/a87bfae50b414d833905d1869f69df0b/example21.py"><code class="xref download docutils literal notranslate"><span class="pre">download</span> <span class="pre">script</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="c1">#</span>
<span class="linenos">  2</span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;KMP_DUPLICATE_LIB_OK&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">  5</span>    <span class="s2">&quot;True&quot;</span>  <span class="c1"># uncomment this line if omp error occurs on OSX for python 3</span>
<span class="linenos">  6</span><span class="p">)</span>
<span class="linenos">  7</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;OMP_NUM_THREADS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>  <span class="c1"># set number of OpenMP threads to run in parallel</span>
<span class="linenos">  8</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;MKL_NUM_THREADS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>  <span class="c1"># set number of MKL threads to run in parallel</span>
<span class="linenos">  9</span><span class="c1">#</span>
<span class="linenos"> 10</span>
<span class="linenos"> 11</span><span class="c1">#######################################################################</span>
<span class="linenos"> 12</span><span class="c1">#                            example 21                               #</span>
<span class="linenos"> 13</span><span class="c1"># This example shows how to use the `Lanczos` submodule of the        #</span>
<span class="linenos"> 14</span><span class="c1"># `tools` module to compute finite temperature expectation values     #</span>
<span class="linenos"> 15</span><span class="c1"># using `FTLM_statc_iteration` and `LTLM_statiic_iteration`.          #</span>
<span class="linenos"> 16</span><span class="c1">#######################################################################</span>
<span class="linenos"> 17</span><span class="kn">from</span> <span class="nn">quspin.basis</span> <span class="kn">import</span> <span class="n">spin_basis_1d</span>
<span class="linenos"> 18</span><span class="kn">from</span> <span class="nn">quspin.operators</span> <span class="kn">import</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">quantum_operator</span>
<span class="linenos"> 19</span><span class="kn">from</span> <span class="nn">quspin.tools.lanczos</span> <span class="kn">import</span> <span class="p">(</span>
<span class="linenos"> 20</span>    <span class="n">lanczos_full</span><span class="p">,</span>
<span class="linenos"> 21</span>    <span class="n">lanczos_iter</span><span class="p">,</span>
<span class="linenos"> 22</span>    <span class="n">FTLM_static_iteration</span><span class="p">,</span>
<span class="linenos"> 23</span>    <span class="n">LTLM_static_iteration</span><span class="p">,</span>
<span class="linenos"> 24</span><span class="p">)</span>
<span class="linenos"> 25</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 26</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 27</span><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
<span class="linenos"> 28</span>
<span class="linenos"> 29</span><span class="c1">#</span>
<span class="linenos"> 30</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1203901</span><span class="p">)</span>  <span class="c1"># fix seed</span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span><span class="c1">#</span>
<span class="linenos"> 34</span><span class="c1">#</span>
<span class="linenos"> 35</span><span class="k">def</span> <span class="nf">bootstrap_mean</span><span class="p">(</span><span class="n">O_r</span><span class="p">,</span> <span class="n">Id_r</span><span class="p">,</span> <span class="n">n_bootstrap</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
<span class="linenos"> 36</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 37</span><span class="sd">    Uses boostraping to esimate the error due to sampling.</span>
<span class="linenos"> 38</span>
<span class="linenos"> 39</span><span class="sd">    O_r: numerator</span>
<span class="linenos"> 40</span><span class="sd">    Id_r: denominator</span>
<span class="linenos"> 41</span><span class="sd">    n_bootstrap: bootstrap sample size</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 44</span>    <span class="n">O_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">O_r</span><span class="p">)</span>
<span class="linenos"> 45</span>    <span class="n">Id_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Id_r</span><span class="p">)</span>
<span class="linenos"> 46</span>    <span class="c1">#</span>
<span class="linenos"> 47</span>    <span class="n">avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">O_r</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">Id_r</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 48</span>    <span class="n">n_Id</span> <span class="o">=</span> <span class="n">Id_r</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos"> 49</span>    <span class="c1"># n_N = O_r.shape[0]</span>
<span class="linenos"> 50</span>    <span class="c1">#</span>
<span class="linenos"> 51</span>    <span class="n">i_iter</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">n_Id</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_Id</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bootstrap</span><span class="p">))</span>
<span class="linenos"> 52</span>    <span class="c1">#</span>
<span class="linenos"> 53</span>    <span class="n">bootstrap_iter</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 54</span>        <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">O_r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">Id_r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos"> 55</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">i_iter</span>
<span class="linenos"> 56</span>    <span class="p">)</span>
<span class="linenos"> 57</span>    <span class="n">diff_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">bootstrap</span> <span class="o">-</span> <span class="n">avg</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">bootstrap</span> <span class="ow">in</span> <span class="n">bootstrap_iter</span><span class="p">)</span>
<span class="linenos"> 58</span>    <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">diff_iter</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_bootstrap</span><span class="p">)</span>
<span class="linenos"> 59</span>    <span class="c1">#</span>
<span class="linenos"> 60</span>    <span class="k">return</span> <span class="n">avg</span><span class="p">,</span> <span class="n">err</span>
<span class="linenos"> 61</span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="c1">#</span>
<span class="linenos"> 64</span><span class="k">def</span> <span class="nf">get_operators</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="linenos"> 65</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 66</span><span class="sd">    Generates hamiltonian for TFIM, see quspin tutorial papers to learn more aabout this</span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 69</span>    <span class="c1"># create basis</span>
<span class="linenos"> 70</span>    <span class="n">basis</span> <span class="o">=</span> <span class="n">spin_basis_1d</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">pauli</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 71</span>    <span class="c1"># site-coupling lists</span>
<span class="linenos"> 72</span>    <span class="n">J_list</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">L</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">)]</span>
<span class="linenos"> 73</span>    <span class="n">h_list</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">)]</span>
<span class="linenos"> 74</span>    <span class="n">M_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">L</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">)]</span>
<span class="linenos"> 75</span>    <span class="c1"># create magnetization-squared operator</span>
<span class="linenos"> 76</span>    <span class="n">M</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="p">([[</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">M_list</span><span class="p">]],</span> <span class="p">[],</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos"> 77</span>    <span class="n">M2</span> <span class="o">=</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span>
<span class="linenos"> 78</span>    <span class="c1"># create parameter-dependent Hamiltonian using quantum_oprator</span>
<span class="linenos"> 79</span>    <span class="n">ops_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;zz&quot;</span><span class="p">,</span> <span class="n">J_list</span><span class="p">]],</span> <span class="n">h</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">h_list</span><span class="p">]])</span>
<span class="linenos"> 80</span>    <span class="n">H</span> <span class="o">=</span> <span class="n">quantum_operator</span><span class="p">(</span><span class="n">ops_dict</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos"> 81</span>    <span class="c1">#</span>
<span class="linenos"> 82</span>    <span class="k">return</span> <span class="n">M2</span><span class="p">,</span> <span class="n">H</span>
<span class="linenos"> 83</span>
<span class="linenos"> 84</span>
<span class="linenos"> 85</span><span class="c1">#</span>
<span class="linenos"> 86</span><span class="k">class</span> <span class="nc">lanczos_wrapper</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="linenos"> 87</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 88</span><span class="sd">    Class that contains minimum requirments to use Lanczos.</span>
<span class="linenos"> 89</span>
<span class="linenos"> 90</span><span class="sd">    Using it is equired, since the dot and dtype methods of quantum_operator objects take more parameters</span>
<span class="linenos"> 91</span>
<span class="linenos"> 92</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 93</span>
<span class="linenos"> 94</span>    <span class="c1">#</span>
<span class="linenos"> 95</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="linenos"> 96</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 97</span><span class="sd">        A: array-like object to assign/overwrite the dot and dtype objects of</span>
<span class="linenos"> 98</span><span class="sd">        kwargs: any optional arguments used when overwriting the methods</span>
<span class="linenos"> 99</span>
<span class="linenos">100</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">101</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_A</span> <span class="o">=</span> <span class="n">A</span>
<span class="linenos">102</span>        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
<span class="linenos">103</span>
<span class="linenos">104</span>    <span class="c1">#</span>
<span class="linenos">105</span>    <span class="k">def</span> <span class="nf">dot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="linenos">106</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">107</span><span class="sd">        Calls the `dot` method of quantum_operator with the parameters fixed to a given value.</span>
<span class="linenos">108</span>
<span class="linenos">109</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">110</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">pars</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span><span class="p">)</span>
<span class="linenos">111</span>
<span class="linenos">112</span>    <span class="c1">#</span>
<span class="linenos">113</span>    <span class="nd">@property</span>
<span class="linenos">114</span>    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos">115</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">116</span><span class="sd">        The dtype attribute is required to figure out result types in lanczos calculations.</span>
<span class="linenos">117</span>
<span class="linenos">118</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">119</span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_A</span><span class="o">.</span><span class="n">dtype</span>
<span class="linenos">120</span>
<span class="linenos">121</span>
<span class="linenos">122</span><span class="c1">#</span>
<span class="linenos">123</span><span class="c1">#</span>
<span class="linenos">124</span><span class="c1">##### define system parameters #####</span>
<span class="linenos">125</span><span class="c1">#</span>
<span class="linenos">126</span><span class="n">L</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># system size</span>
<span class="linenos">127</span><span class="n">m</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># dimensio of Krylov space</span>
<span class="linenos">128</span><span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># transverse-field Ising model parameter: H = sZZ + (1-s)X</span>
<span class="linenos">129</span><span class="c1">#</span>
<span class="linenos">130</span><span class="n">N_samples</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># of samples to approximate thermal expectation value with</span>
<span class="linenos">131</span><span class="c1">#</span>
<span class="linenos">132</span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># temperature vector</span>
<span class="linenos">133</span><span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">T</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>  <span class="c1"># inverse temperature vector</span>
<span class="linenos">134</span><span class="c1">#</span>
<span class="linenos">135</span><span class="c1">##### get operators #####</span>
<span class="linenos">136</span><span class="c1">#</span>
<span class="linenos">137</span><span class="n">M2</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">get_operators</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="linenos">138</span><span class="c1"># crate wrapper for quantum_operator</span>
<span class="linenos">139</span><span class="n">H_wrapped</span> <span class="o">=</span> <span class="n">lanczos_wrapper</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">J</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">))</span>
<span class="linenos">140</span><span class="c1"># calculate ground state energy to use as shift that will prevent overflows (i.e. numerical instabilities)</span>
<span class="linenos">141</span><span class="p">[</span><span class="n">E0</span><span class="p">]</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigsh</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;SA&quot;</span><span class="p">,</span> <span class="n">pars</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">),</span> <span class="n">return_eigenvectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">142</span><span class="c1">#</span>
<span class="linenos">143</span><span class="c1">##### finite temperature methods #####</span>
<span class="linenos">144</span><span class="c1">#</span>
<span class="linenos">145</span><span class="c1"># preallocate lists to store results from iterations</span>
<span class="linenos">146</span><span class="n">M2_FT_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">147</span><span class="n">M2_LT_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">148</span><span class="n">Z_FT_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">149</span><span class="n">Z_LT_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">150</span><span class="c1">#</span>
<span class="linenos">151</span><span class="c1"># allocate memory for lanczos vectors</span>
<span class="linenos">152</span><span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">Ns</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">153</span><span class="c1">#</span>
<span class="linenos">154</span><span class="c1"># calculate iterations</span>
<span class="linenos">155</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_samples</span><span class="p">):</span>
<span class="linenos">156</span>    <span class="c1"># generate normalized random vector</span>
<span class="linenos">157</span>    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">H</span><span class="o">.</span><span class="n">Ns</span><span class="p">)</span>
<span class="linenos">158</span>    <span class="n">r</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="linenos">159</span>    <span class="c1"># get lanczos basis</span>
<span class="linenos">160</span>    <span class="n">E</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">lv</span> <span class="o">=</span> <span class="n">lanczos_full</span><span class="p">(</span><span class="n">H_wrapped</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">full_ortho</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">161</span>    <span class="c1"># E,V,lv = lanczos_full(H_wrapped,r,m,eps=1e-8,full_ortho=False)</span>
<span class="linenos">162</span>    <span class="c1"># E,V,lv = lanczos_iter(H_wrapped,r,m,eps=1e-8)</span>
<span class="linenos">163</span>    <span class="c1"># shift energy to avoid overflows</span>
<span class="linenos">164</span>    <span class="n">E</span> <span class="o">-=</span> <span class="n">E0</span>
<span class="linenos">165</span>    <span class="c1"># calculate iteration</span>
<span class="linenos">166</span>    <span class="n">results_FT</span><span class="p">,</span> <span class="n">Id_FT</span> <span class="o">=</span> <span class="n">FTLM_static_iteration</span><span class="p">({</span><span class="s2">&quot;M2&quot;</span><span class="p">:</span> <span class="n">M2</span><span class="p">},</span> <span class="n">E</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">lv</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
<span class="linenos">167</span>    <span class="n">results_LT</span><span class="p">,</span> <span class="n">Id_LT</span> <span class="o">=</span> <span class="n">LTLM_static_iteration</span><span class="p">({</span><span class="s2">&quot;M2&quot;</span><span class="p">:</span> <span class="n">M2</span><span class="p">},</span> <span class="n">E</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">lv</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
<span class="linenos">168</span>    <span class="c1"># save results to a list</span>
<span class="linenos">169</span>    <span class="n">M2_FT_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results_FT</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">])</span>
<span class="linenos">170</span>    <span class="n">Z_FT_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Id_FT</span><span class="p">)</span>
<span class="linenos">171</span>    <span class="n">M2_LT_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results_LT</span><span class="p">[</span><span class="s2">&quot;M2&quot;</span><span class="p">])</span>
<span class="linenos">172</span>    <span class="n">Z_LT_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Id_LT</span><span class="p">)</span>
<span class="linenos">173</span><span class="c1">#</span>
<span class="linenos">174</span><span class="c1"># calculating error bars on the expectation values</span>
<span class="linenos">175</span><span class="n">m2_FT</span><span class="p">,</span> <span class="n">dm2_FT</span> <span class="o">=</span> <span class="n">bootstrap_mean</span><span class="p">(</span><span class="n">M2_FT_list</span><span class="p">,</span> <span class="n">Z_FT_list</span><span class="p">)</span>
<span class="linenos">176</span><span class="n">m2_LT</span><span class="p">,</span> <span class="n">dm2_LT</span> <span class="o">=</span> <span class="n">bootstrap_mean</span><span class="p">(</span><span class="n">M2_LT_list</span><span class="p">,</span> <span class="n">Z_LT_list</span><span class="p">)</span>
<span class="linenos">177</span><span class="c1">#</span>
<span class="linenos">178</span><span class="c1">##### calculating exact results from full diagonalization #####</span>
<span class="linenos">179</span><span class="c1">#</span>
<span class="linenos">180</span><span class="n">dim_cutoff</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># Hilbert space dimension cutoff</span>
<span class="linenos">181</span><span class="k">if</span> <span class="n">H</span><span class="o">.</span><span class="n">Ns</span> <span class="o">&lt;</span> <span class="n">dim_cutoff</span><span class="p">:</span>  <span class="c1"># Hilbert space is not too big to diagonalize on a laptop</span>
<span class="linenos">182</span>    <span class="c1">#</span>
<span class="linenos">183</span>    <span class="c1"># adding more points for smooth line</span>
<span class="linenos">184</span>    <span class="n">T_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">min</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span> <span class="mi">10</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
<span class="linenos">185</span>    <span class="n">beta_new</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">T_new</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>
<span class="linenos">186</span>    <span class="c1">#</span>
<span class="linenos">187</span>    <span class="c1"># full diagonaization of H</span>
<span class="linenos">188</span>    <span class="n">E</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">pars</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">s</span><span class="p">))</span>
<span class="linenos">189</span>    <span class="c1"># shift energy to avoid overflows</span>
<span class="linenos">190</span>    <span class="n">E</span> <span class="o">-=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">191</span>    <span class="c1"># get boltzmann weights for each temperature</span>
<span class="linenos">192</span>    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">beta_new</span><span class="p">))</span>
<span class="linenos">193</span>    <span class="c1"># get diagonal matrix elements for trace</span>
<span class="linenos">194</span>    <span class="n">O</span> <span class="o">=</span> <span class="n">M2</span><span class="o">.</span><span class="n">matrix_ele</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">diagonal</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">195</span>    <span class="c1"># calculate trace</span>
<span class="linenos">196</span>    <span class="n">O</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;j...,j-&gt;...&quot;</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">O</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;j...-&gt;...&quot;</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
<span class="linenos">197</span><span class="c1">#</span>
<span class="linenos">198</span><span class="c1">#</span>
<span class="linenos">199</span><span class="c1">##### plot results #####</span>
<span class="linenos">200</span><span class="c1">#</span>
<span class="linenos">201</span><span class="c1"># setting up plot and inset</span>
<span class="linenos">202</span><span class="n">h</span> <span class="o">=</span> <span class="mf">4.2</span>  <span class="c1"># figure aspect ratio parameter</span>
<span class="linenos">203</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>
<span class="linenos">204</span><span class="n">axinset</span> <span class="o">=</span> <span class="n">inset_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;45%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;65%&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
<span class="linenos">205</span><span class="n">axs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ax</span><span class="p">,</span> <span class="n">axinset</span><span class="p">]</span>
<span class="linenos">206</span><span class="c1">#</span>
<span class="linenos">207</span><span class="c1"># plot results for FTLM and LTLM.</span>
<span class="linenos">208</span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axs</span><span class="p">:</span>
<span class="linenos">209</span>    <span class="n">a</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">m2_LT</span><span class="p">,</span> <span class="n">dm2_LT</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;LTLM&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">210</span>    <span class="n">a</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">m2_FT</span><span class="p">,</span> <span class="n">dm2_FT</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FTLM&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos">211</span>    <span class="c1">#</span>
<span class="linenos">212</span>    <span class="k">if</span> <span class="n">H</span><span class="o">.</span><span class="n">Ns</span> <span class="o">&lt;</span> <span class="n">dim_cutoff</span><span class="p">:</span>  <span class="c1"># hilbert space is not too big to diagonalize on a laptop</span>
<span class="linenos">213</span>        <span class="n">a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_new</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="linenos">214</span>    <span class="c1">#</span>
<span class="linenos">215</span>    <span class="n">a</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="linenos">216</span><span class="c1">#</span>
<span class="linenos">217</span><span class="c1"># adding space for inset by expanding x limits.</span>
<span class="linenos">218</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="linenos">219</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">xmax</span><span class="p">))</span>
<span class="linenos">220</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">)</span>
<span class="linenos">221</span><span class="c1">#</span>
<span class="linenos">222</span><span class="c1"># inset adjustment to zoom in low-temp limit.</span>
<span class="linenos">223</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">axinset</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="linenos">224</span><span class="c1">#</span>
<span class="linenos">225</span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.6</span>
<span class="linenos">226</span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">T</span> <span class="o">&gt;=</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">T</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="linenos">227</span><span class="n">axinset</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">xmin</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)))</span>
<span class="linenos">228</span><span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m2_LT</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">m2_FT</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="linenos">229</span><span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">m2_LT</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">m2_FT</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="linenos">230</span><span class="n">ywin</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">-</span> <span class="n">ymin</span>
<span class="linenos">231</span><span class="n">boundy</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">ywin</span>
<span class="linenos">232</span><span class="n">axinset</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span> <span class="o">-</span> <span class="n">boundy</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">+</span> <span class="n">boundy</span><span class="p">))</span>
<span class="linenos">233</span><span class="c1">#</span>
<span class="linenos">234</span><span class="c1"># display plot</span>
<span class="linenos">235</span><span class="c1">#plt.tight_layout()</span>
<span class="linenos">236</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos">237</span><span class="c1">#</span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Phillip Weinberg, Markus Schmitt, and Marin Bukov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6885KZ7NH6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6885KZ7NH6', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>