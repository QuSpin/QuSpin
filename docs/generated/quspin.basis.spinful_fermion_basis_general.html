<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>quspin.basis.spinful_fermion_basis_general &mdash; QuSpin 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../static/css/sphinx_rtd_size.css?v=f26ae176" />
      <link rel="stylesheet" type="text/css" href="../static/css/py_class_property_fix.css?v=faf79ccd" />

  
  <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../static/jquery.js?v=5d32c60e"></script>
        <script src="../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../static/documentation_options.js?v=8d563738"></script>
        <script src="../static/doctools.js?v=9a2dae69"></script>
        <script src="../static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="quspin.basis.user_basis" href="quspin.basis.user_basis.html" />
    <link rel="prev" title="quspin.basis.spinless_fermion_basis_general" href="quspin.basis.spinless_fermion_basis_general.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            QuSpin
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">QuSpin (public API)</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../basis.html">Basis module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.basis</span></code>)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../basis.html#one-dimensional-symmetries">one-dimensional symmetries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../basis.html#general-lattice-symmetries">general lattice symmetries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quspin.basis.spin_basis_general.html">quspin.basis.spin_basis_general</a></li>
<li class="toctree-l3"><a class="reference internal" href="quspin.basis.boson_basis_general.html">quspin.basis.boson_basis_general</a></li>
<li class="toctree-l3"><a class="reference internal" href="quspin.basis.spinless_fermion_basis_general.html">quspin.basis.spinless_fermion_basis_general</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">quspin.basis.spinful_fermion_basis_general</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general"><code class="docutils literal notranslate"><span class="pre">spinful_fermion_basis_general</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../basis.html#user-basis">user basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basis.html#combining-basis-classes">combining basis classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basis.html#functions">functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basis.html#large-integer-support-for-general-basis-classes">large integer support for general basis classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../operators.html">Operators module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.operators</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.tools</span></code>)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation &amp; Use</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html#basics-of-command-line-use">Basics of command line use</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../example_scripts.html">Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter_notebooks.html">Jupyter notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/parallelization.html">Parallel computing support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/user_basis.html"><cite>user_basis</cite> tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bugs &amp; Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute/report_a_bug.html">Report a bug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/ask_a_question.html">Ask a question</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuSpin</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../basis.html">Basis module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.basis</span></code>)</a></li>
      <li class="breadcrumb-item active">quspin.basis.spinful_fermion_basis_general</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../sources/generated/quspin.basis.spinful_fermion_basis_general.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style> .red {color:#ff0000; font-weight:bold; font-style:italic; } </style>
<style> .green {color:#00b200; font-weight:bold; font-style:italic; } </style>
<style> .magenta {color:#FF33F3; font-weight:bold; font-style:italic; } </style>
<style> .orange {color:#FE8E02; font-weight:bold; font-style:italic; } </style><section id="quspin-basis-spinful-fermion-basis-general">
<h1>quspin.basis.spinful_fermion_basis_general<a class="headerlink" href="#quspin-basis-spinful-fermion-basis-general" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">quspin.basis.</span></span><span class="sig-name descname"><span class="pre">spinful_fermion_basis_general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ns_block_est</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple_symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double_occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">blocks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="quspin.basis.spinless_fermion_basis_general.html#quspin.basis.spinless_fermion_basis_general" title="quspin.basis.basis_general.fermion.spinless_fermion_basis_general"><code class="xref py py-class docutils literal notranslate"><span class="pre">spinless_fermion_basis_general</span></code></a></p>
<p>Constructs basis for spinful fermion operators for USER-DEFINED symmetries.</p>
<p>Any unitary symmetry transformation <span class="math notranslate nohighlight">\(Q\)</span> of periodicity <span class="math notranslate nohighlight">\(m_Q\)</span> (<span class="math notranslate nohighlight">\(Q^{m_Q}=1\)</span>) has eigenvalues <span class="math notranslate nohighlight">\(\exp(-2\pi i q/m_Q)\)</span>, labelled by an ingeter <span class="math notranslate nohighlight">\(q\in\{0,1,\dots,m_Q-1\}\)</span>. These integers <span class="math notranslate nohighlight">\(q\)</span> are used to define the symmetry blocks.</p>
<p>For instance, if <span class="math notranslate nohighlight">\(Q=P\)</span> is parity (reflection), then <span class="math notranslate nohighlight">\(q=0,1\)</span>. If <span class="math notranslate nohighlight">\(Q=T\)</span> is translation by one lattice site, then <span class="math notranslate nohighlight">\(q\)</span> labels the mometum blocks in the same fashion as for the <cite>…_basis_1d</cite> classes.</p>
<dl class="simple">
<dt>User-defined symmetries with the <cite>spinful_fermion_basis_general</cite> class can be programmed in two equivalent ways: <em>simple</em> and <em>advanced</em>.</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><em>simple</em> symmetry definition (see optional argument <cite>simple_symm</cite>) uses the pipe symbol, “|”, in the operator string (see site-coupling lists in example below) to distinguish between the spin-up and spin-down species. Suppose we have a system of L sites. In the <em>simple</em> case, the lattice sites are enumerated <span class="math notranslate nohighlight">\(s=(s_0,s_1,\dots,s_{L-1})\)</span> for <strong>both</strong> spin-up and spin-down. There are two types of operations one can perform on the sites:</dt><dd><ul>
<li><p>exchange the labels of two sites: <span class="math notranslate nohighlight">\(s_i \leftrightarrow s_j\)</span> (e.g., translation, parity)</p></li>
<li><p>invert the <strong>fermion spin</strong> on a given site: <span class="math notranslate nohighlight">\(s_i\leftrightarrow -(s_j+1)\)</span> (e.g., fermion spin inversion)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><em>advanced</em> symmetry definition (see optional argument <cite>simple_symm</cite>) does NOT use any pipe symbol in the operator string to distinguish between the spin-up and spin-down species. In the <em>advanced</em> case, the sites are enumerated <span class="math notranslate nohighlight">\(s=(s_0,s_1,\dots,s_{L-1}; s_{L},s_{L+1},\dots,s_{2L-1})\)</span>, where the first L sites label spin-up, and the last L sites – spin-down. There are two types of operations one can perform on the sites:</dt><dd><ul>
<li><p>exchange the labels of two sites: <span class="math notranslate nohighlight">\(s_i \leftrightarrow s_j\)</span> (e.g., translation, parity, fermion spin inversion)</p></li>
<li><p>invert the <strong>fermion population</strong> on a given site with appropriate sign flip (see <cite>“z”</cite> operator string) <span class="math notranslate nohighlight">\(c_j^\dagger\to (-1)^j c_j\)</span>: <span class="math notranslate nohighlight">\(s_i\leftrightarrow -(s_j+1)\)</span> (e.g., particle-hole symmetry)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>These two operations already comprise a variety of symmetries, including translation, parity (reflection), fermion-spin inversion and particle-hole like symmetries. For specific examples, see below.</p>
<p>The supported operator strings for <cite>spinful_fermion_basis_general</cite> are:</p>
<div class="math notranslate nohighlight">
\[\begin{array}{cccc}
        \texttt{basis}/\texttt{opstr}   &amp;   \texttt{&quot;I&quot;}   &amp;   \texttt{&quot;+&quot;}   &amp;   \texttt{&quot;-&quot;}  &amp;   \texttt{&quot;n&quot;}   &amp;   \texttt{&quot;z&quot;}    &amp;   \texttt{&quot;x&quot;}    &amp;   \texttt{&quot;y&quot;}    \newline
        \texttt{spinful_fermion_basis_general}&amp; \hat{1}        &amp;   \hat c^\dagger      &amp;       \hat c          &amp; \hat c^\dagger c     &amp;  \hat c^\dagger\hat c - \frac{1}{2}  &amp;   \hat c + \hat c^\dagger    &amp;   -i\left( \hat c - \hat c^\dagger\right)   \newline
\end{array}\]</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The definition of the operation <span class="math notranslate nohighlight">\(s_i\leftrightarrow -(s_j+1)\)</span> <strong>differs</strong> for the <em>simple</em> and <em>advanced</em> cases.</p></li>
<li><p>For particle-hole symmetry, please use exclusively the operator string <cite>“z”</cite> (see table), otherwise the automatic symmetry check will raise an error when set to <cite>check_symm=True</cite>.</p></li>
<li><p>QuSpin raises a warning to alert the reader when non-commuting symmetries are passed. In such cases, we recommend the user to manually check the combined usage of symmetries by, e.g., comparing the eigenvalues.</p></li>
<li><p>The fermion operator strings “x” and “y” correspond to real fermions, i.e. Majorana operators (note the sign difference between “y” and the <span class="math notranslate nohighlight">\(\sigma^y\)</span> Pauli matrix, which is convention).</p></li>
</ul>
<p class="rubric">Examples</p>
<p>The code snippets below show how to construct the two-dimensional Fermi-Hubbard model with onsite interactions.</p>
<div class="math notranslate nohighlight">
\[H = -J \sum_{\langle ij\rangle,\sigma} c^\dagger_{i\sigma}c_{j\sigma} + \mathrm{h.c.} - \mu\sum_{j,\sigma} n_{j\sigma} + U\sum_j n_{j\uparrow} n_{j\downarrow}\]</div>
<p>The first code snippet demonstrates how to pass <strong>simple</strong> user-defined symmetries to the <cite>spinful_fermion_basis_general</cite> constructor. In particular,
we do translation invariance and fermion spin inversion.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">quspin.basis</span> <span class="kn">import</span> <span class="n">spinful_fermion_basis_general</span>  <span class="c1"># spin basis constructor</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># general math functions</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">#</span>
<span class="linenos"> 5</span><span class="c1">###### define model parameters ######</span>
<span class="linenos"> 6</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span>  <span class="c1"># linear dimension of spin 1 2d lattice</span>
<span class="linenos"> 7</span><span class="n">N_2d</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">*</span> <span class="n">Ly</span>  <span class="c1"># number of sites for spin 1</span>
<span class="linenos"> 8</span><span class="c1">#</span>
<span class="linenos"> 9</span><span class="n">J</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># hopping matrix element</span>
<span class="linenos">10</span><span class="n">U</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># onsite interaction</span>
<span class="linenos">11</span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># chemical potential</span>
<span class="linenos">12</span><span class="c1">#</span>
<span class="linenos">13</span><span class="c1">###### setting up user-defined BASIC symmetry transformations for 2d lattice ######</span>
<span class="linenos">14</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)</span>  <span class="c1"># sites [0,1,2,...,N_2d-1] in simple notation</span>
<span class="linenos">15</span><span class="n">x</span> <span class="o">=</span> <span class="n">s</span> <span class="o">%</span> <span class="n">Lx</span>  <span class="c1"># x positions for sites</span>
<span class="linenos">16</span><span class="n">y</span> <span class="o">=</span> <span class="n">s</span> <span class="o">//</span> <span class="n">Lx</span>  <span class="c1"># y positions for sites</span>
<span class="linenos">17</span><span class="n">T_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Lx</span> <span class="o">+</span> <span class="n">Lx</span> <span class="o">*</span> <span class="n">y</span>  <span class="c1"># translation along x-direction</span>
<span class="linenos">18</span><span class="n">T_y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">Lx</span> <span class="o">*</span> <span class="p">((</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Ly</span><span class="p">)</span>  <span class="c1"># translation along y-direction</span>
<span class="linenos">19</span><span class="n">S</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># fermion spin inversion in the simple case</span>
<span class="linenos">20</span><span class="c1">#</span>
<span class="linenos">21</span><span class="c1">###### setting up bases ######</span>
<span class="linenos">22</span><span class="n">basis_2d</span> <span class="o">=</span> <span class="n">spinful_fermion_basis_general</span><span class="p">(</span>
<span class="linenos">23</span>    <span class="n">N_2d</span><span class="p">,</span> <span class="n">Nf</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">kxblock</span><span class="o">=</span><span class="p">(</span><span class="n">T_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">kyblock</span><span class="o">=</span><span class="p">(</span><span class="n">T_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">sblock</span><span class="o">=</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">24</span><span class="p">)</span>
<span class="linenos">25</span><span class="c1">#</span>
<span class="linenos">26</span><span class="c1">###### setting up hamiltonian ######</span>
<span class="linenos">27</span><span class="c1"># setting up site-coupling lists for simple case</span>
<span class="linenos">28</span><span class="n">hopping_left</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
<span class="linenos">29</span>    <span class="p">[</span><span class="o">-</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">30</span><span class="p">]</span>
<span class="linenos">31</span><span class="n">hopping_right</span> <span class="o">=</span> <span class="p">[[</span><span class="o">+</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
<span class="linenos">32</span>    <span class="p">[</span><span class="o">+</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">33</span><span class="p">]</span>
<span class="linenos">34</span><span class="n">potential</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)]</span>
<span class="linenos">35</span><span class="n">interaction</span> <span class="o">=</span> <span class="p">[[</span><span class="n">U</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)]</span>
<span class="linenos">36</span><span class="c1">#</span>
<span class="linenos">37</span><span class="n">static</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">38</span>    <span class="p">[</span><span class="s2">&quot;+-|&quot;</span><span class="p">,</span> <span class="n">hopping_left</span><span class="p">],</span>  <span class="c1"># spin up hops to left</span>
<span class="linenos">39</span>    <span class="p">[</span><span class="s2">&quot;-+|&quot;</span><span class="p">,</span> <span class="n">hopping_right</span><span class="p">],</span>  <span class="c1"># spin up hops to right</span>
<span class="linenos">40</span>    <span class="p">[</span><span class="s2">&quot;|+-&quot;</span><span class="p">,</span> <span class="n">hopping_left</span><span class="p">],</span>  <span class="c1"># spin down hopes to left</span>
<span class="linenos">41</span>    <span class="p">[</span><span class="s2">&quot;|-+&quot;</span><span class="p">,</span> <span class="n">hopping_right</span><span class="p">],</span>  <span class="c1"># spin up hops to right</span>
<span class="linenos">42</span>    <span class="p">[</span><span class="s2">&quot;n|&quot;</span><span class="p">,</span> <span class="n">potential</span><span class="p">],</span>  <span class="c1"># onsite potenial, spin up</span>
<span class="linenos">43</span>    <span class="p">[</span><span class="s2">&quot;|n&quot;</span><span class="p">,</span> <span class="n">potential</span><span class="p">],</span>  <span class="c1"># onsite potential, spin down</span>
<span class="linenos">44</span>    <span class="p">[</span><span class="s2">&quot;n|n&quot;</span><span class="p">,</span> <span class="n">interaction</span><span class="p">],</span>
<span class="linenos">45</span><span class="p">]</span>  <span class="c1"># spin up-spin down interaction</span>
<span class="linenos">46</span><span class="c1"># build hamiltonian</span>
<span class="linenos">47</span><span class="n">H</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">static</span><span class="p">,</span> <span class="p">[],</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis_2d</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">48</span><span class="c1"># diagonalise H</span>
<span class="linenos">49</span><span class="n">E</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">()</span>
</pre></div>
</div>
<p>The second code snippet demonstrates how to pass <strong>advanced</strong> user-defined symmetries to the <cite>spinful_fermion_basis_general</cite> constructor. Like above,
we do translation invariance and fermion spin inversion.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">quspin.basis</span> <span class="kn">import</span> <span class="n">spinful_fermion_basis_general</span>  <span class="c1"># spin basis constructor</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># general math functions</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">#</span>
<span class="linenos"> 5</span><span class="c1">###### define model parameters ######</span>
<span class="linenos"> 6</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span>  <span class="c1"># linear dimension of spin 1 2d lattice</span>
<span class="linenos"> 7</span><span class="n">N_2d</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">*</span> <span class="n">Ly</span>  <span class="c1"># number of sites for spin 1</span>
<span class="linenos"> 8</span><span class="c1">#</span>
<span class="linenos"> 9</span><span class="n">J</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># hopping matrix element</span>
<span class="linenos">10</span><span class="n">U</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># onsite interaction</span>
<span class="linenos">11</span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># chemical potential</span>
<span class="linenos">12</span><span class="c1">#</span>
<span class="linenos">13</span><span class="c1">###### setting up user-defined BASIC symmetry transformations for 2d lattice ######</span>
<span class="linenos">14</span><span class="c1"># we build the advanced symmetry operations operations by concatenating operations for a single spin species</span>
<span class="linenos">15</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)</span> <span class="o">%</span> <span class="n">Lx</span>  <span class="c1"># x positions for sites for one spin species</span>
<span class="linenos">16</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)</span> <span class="o">//</span> <span class="n">Lx</span>  <span class="c1"># y positions for sites for one spin species</span>
<span class="linenos">17</span><span class="n">t_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Lx</span> <span class="o">+</span> <span class="n">Lx</span> <span class="o">*</span> <span class="n">y</span>  <span class="c1"># translation along x-direction for one spin species</span>
<span class="linenos">18</span><span class="n">t_y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">Lx</span> <span class="o">*</span> <span class="p">((</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Ly</span><span class="p">)</span>  <span class="c1"># translation along y-direction for one spin species</span>
<span class="linenos">19</span><span class="c1"># create the spin-up spin-down combined transformations</span>
<span class="linenos">20</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)</span>  <span class="c1"># sites [0,1,2,...,N_2d-1,...,2*N_2d-1] in advanced notation</span>
<span class="linenos">21</span><span class="n">T_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
<span class="linenos">22</span>    <span class="p">(</span><span class="n">t_x</span><span class="p">,</span> <span class="n">t_x</span> <span class="o">+</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">23</span><span class="p">)</span>  <span class="c1"># translation along x-direction for both spin species</span>
<span class="linenos">24</span><span class="n">T_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
<span class="linenos">25</span>    <span class="p">(</span><span class="n">t_y</span><span class="p">,</span> <span class="n">t_y</span> <span class="o">+</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">26</span><span class="p">)</span>  <span class="c1"># translation along y-direction for both spin species</span>
<span class="linenos">27</span><span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">N_2d</span><span class="p">)</span>  <span class="c1"># fermion spin inversion in the advanced case</span>
<span class="linenos">28</span><span class="c1">#</span>
<span class="linenos">29</span><span class="c1">###### setting up bases ###### (note optional argument simple_symm=False)</span>
<span class="linenos">30</span><span class="n">basis_2d</span> <span class="o">=</span> <span class="n">spinful_fermion_basis_general</span><span class="p">(</span>
<span class="linenos">31</span>    <span class="n">N_2d</span><span class="p">,</span>
<span class="linenos">32</span>    <span class="n">simple_symm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">33</span>    <span class="n">Nf</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="linenos">34</span>    <span class="n">kxblock</span><span class="o">=</span><span class="p">(</span><span class="n">T_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="linenos">35</span>    <span class="n">kyblock</span><span class="o">=</span><span class="p">(</span><span class="n">T_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="linenos">36</span>    <span class="n">sblock</span><span class="o">=</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="linenos">37</span><span class="p">)</span>
<span class="linenos">38</span><span class="c1">#</span>
<span class="linenos">39</span><span class="c1">###### setting up hamiltonian ######</span>
<span class="linenos">40</span><span class="c1"># setting up site-coupling lists for advanced case</span>
<span class="linenos">41</span><span class="n">hopping_left</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
<span class="linenos">42</span>    <span class="p">[</span><span class="o">-</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">43</span><span class="p">]</span>
<span class="linenos">44</span><span class="n">hopping_right</span> <span class="o">=</span> <span class="p">[[</span><span class="o">+</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
<span class="linenos">45</span>    <span class="p">[</span><span class="o">+</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">46</span><span class="p">]</span>
<span class="linenos">47</span><span class="n">potential</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)]</span>
<span class="linenos">48</span><span class="n">interaction</span> <span class="o">=</span> <span class="p">[[</span><span class="n">U</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">N_2d</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)]</span>
<span class="linenos">49</span><span class="c1">#</span>
<span class="linenos">50</span><span class="n">static</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">51</span>    <span class="p">[</span><span class="s2">&quot;+-&quot;</span><span class="p">,</span> <span class="n">hopping_left</span><span class="p">],</span>  <span class="c1"># spin-up and spin-down hop to left</span>
<span class="linenos">52</span>    <span class="p">[</span><span class="s2">&quot;-+&quot;</span><span class="p">,</span> <span class="n">hopping_right</span><span class="p">],</span>  <span class="c1"># spin-up and spin-down hop to right</span>
<span class="linenos">53</span>    <span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="n">potential</span><span class="p">],</span>  <span class="c1"># onsite potential for spin-up and spin-down</span>
<span class="linenos">54</span>    <span class="p">[</span><span class="s2">&quot;nn&quot;</span><span class="p">,</span> <span class="n">interaction</span><span class="p">],</span>
<span class="linenos">55</span><span class="p">]</span>  <span class="c1"># spin-up spin-down interaction</span>
<span class="linenos">56</span><span class="c1"># build hamiltonian</span>
<span class="linenos">57</span><span class="n">H</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">static</span><span class="p">,</span> <span class="p">[],</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis_2d</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">58</span><span class="c1"># diagonalise H</span>
<span class="linenos">59</span><span class="n">E</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigvalsh</span><span class="p">()</span>
</pre></div>
</div>
<p>The third code snippet demonstrates how to pass <strong>advanced</strong> user-defined particle-hole symemtry to the <cite>spinful_fermion_basis_general</cite> constructor with translational invariance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span> <span class="nn">quspin.basis</span> <span class="kn">import</span> <span class="n">spinful_fermion_basis_general</span>  <span class="c1"># spin basis constructor</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># general math functions</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1">#</span>
<span class="linenos"> 5</span><span class="c1">###### define model parameters ######</span>
<span class="linenos"> 6</span><span class="n">Lx</span><span class="p">,</span> <span class="n">Ly</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span>  <span class="c1"># linear dimension of spin 1 2d lattice</span>
<span class="linenos"> 7</span><span class="n">N_2d</span> <span class="o">=</span> <span class="n">Lx</span> <span class="o">*</span> <span class="n">Ly</span>  <span class="c1"># number of sites for spin 1</span>
<span class="linenos"> 8</span><span class="c1">#</span>
<span class="linenos"> 9</span><span class="n">J</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># hopping matrix element</span>
<span class="linenos">10</span><span class="n">U</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># onsite interaction</span>
<span class="linenos">11</span><span class="c1">#</span>
<span class="linenos">12</span><span class="c1">###### setting up user-defined BASIC symmetry transformations for 2d lattice ######</span>
<span class="linenos">13</span><span class="c1"># we build the advanced symmetry operations operations by concatenating operations for a single spin species</span>
<span class="linenos">14</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)</span> <span class="o">%</span> <span class="n">Lx</span>  <span class="c1"># x positions for sites for one spin species</span>
<span class="linenos">15</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)</span> <span class="o">//</span> <span class="n">Lx</span>  <span class="c1"># y positions for sites for one spin species</span>
<span class="linenos">16</span><span class="n">t_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Lx</span> <span class="o">+</span> <span class="n">Lx</span> <span class="o">*</span> <span class="n">y</span>  <span class="c1"># translation along x-direction for one spin species</span>
<span class="linenos">17</span><span class="n">t_y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">Lx</span> <span class="o">*</span> <span class="p">((</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Ly</span><span class="p">)</span>  <span class="c1"># translation along y-direction for one spin species</span>
<span class="linenos">18</span><span class="c1"># create the spin-up spin-down combined transformations</span>
<span class="linenos">19</span><span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)</span>  <span class="c1"># sites [0,1,2,...,N_2d-1,...,2*N_2d-1] in advanced notation</span>
<span class="linenos">20</span><span class="n">T_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
<span class="linenos">21</span>    <span class="p">(</span><span class="n">t_x</span><span class="p">,</span> <span class="n">t_x</span> <span class="o">+</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">22</span><span class="p">)</span>  <span class="c1"># translation along x-direction for both spin species</span>
<span class="linenos">23</span><span class="n">T_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
<span class="linenos">24</span>    <span class="p">(</span><span class="n">t_y</span><span class="p">,</span> <span class="n">t_y</span> <span class="o">+</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">25</span><span class="p">)</span>  <span class="c1"># translation along y-direction for both spin species</span>
<span class="linenos">26</span><span class="n">PH</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># particle-hole in the advanced case</span>
<span class="linenos">27</span><span class="c1">#</span>
<span class="linenos">28</span><span class="c1">###### setting up bases ###### (note optional argument simple_symm=False)</span>
<span class="linenos">29</span><span class="c1"># basis_2d=spinful_fermion_basis_general(N_2d,simple_symm=False,Nf=(2,2),kxblock=(T_x,0),kyblock=(T_y,0))</span>
<span class="linenos">30</span><span class="n">basis_2d</span> <span class="o">=</span> <span class="n">spinful_fermion_basis_general</span><span class="p">(</span>
<span class="linenos">31</span>    <span class="n">N_2d</span><span class="p">,</span>
<span class="linenos">32</span>    <span class="n">simple_symm</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="linenos">33</span>    <span class="n">Nf</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="linenos">34</span>    <span class="n">kxblock</span><span class="o">=</span><span class="p">(</span><span class="n">T_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="linenos">35</span>    <span class="n">kyblock</span><span class="o">=</span><span class="p">(</span><span class="n">T_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="linenos">36</span>    <span class="n">phblock</span><span class="o">=</span><span class="p">(</span><span class="n">PH</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="linenos">37</span><span class="p">)</span>
<span class="linenos">38</span><span class="c1">#</span>
<span class="linenos">39</span><span class="c1">###### setting up hamiltonian ######</span>
<span class="linenos">40</span><span class="c1"># setting up site-coupling lists for advanced case</span>
<span class="linenos">41</span><span class="n">hopping_left</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
<span class="linenos">42</span>    <span class="p">[</span><span class="o">-</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">43</span><span class="p">]</span>
<span class="linenos">44</span><span class="n">hopping_right</span> <span class="o">=</span> <span class="p">[[</span><span class="o">+</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_x</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
<span class="linenos">45</span>    <span class="p">[</span><span class="o">+</span><span class="n">J</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N_2d</span><span class="p">)</span>
<span class="linenos">46</span><span class="p">]</span>
<span class="linenos">47</span><span class="n">interaction</span> <span class="o">=</span> <span class="p">[[</span><span class="n">U</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="n">N_2d</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_2d</span><span class="p">)]</span>
<span class="linenos">48</span><span class="c1">#</span>
<span class="linenos">49</span><span class="n">static</span> <span class="o">=</span> <span class="p">[</span>
<span class="linenos">50</span>    <span class="p">[</span><span class="s2">&quot;+-&quot;</span><span class="p">,</span> <span class="n">hopping_left</span><span class="p">],</span>  <span class="c1"># spin-up and spin-down hop to left</span>
<span class="linenos">51</span>    <span class="p">[</span><span class="s2">&quot;-+&quot;</span><span class="p">,</span> <span class="n">hopping_right</span><span class="p">],</span>  <span class="c1"># spin-up and spin-down hop to right</span>
<span class="linenos">52</span>    <span class="p">[</span><span class="s2">&quot;zz&quot;</span><span class="p">,</span> <span class="n">interaction</span><span class="p">],</span>
<span class="linenos">53</span><span class="p">]</span>  <span class="c1"># spin-up spin-down interaction</span>
<span class="linenos">54</span><span class="c1"># build hamiltonian</span>
<span class="linenos">55</span><span class="n">H</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">static</span><span class="p">,</span> <span class="p">[],</span> <span class="n">basis</span><span class="o">=</span><span class="n">basis_2d</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="linenos">56</span><span class="c1"># diagonalise H</span>
<span class="linenos">57</span><span class="n">E</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">eigsh</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;SA&quot;</span><span class="p">,</span> <span class="n">return_eigenvectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">58</span><span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ns_block_est</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simple_symm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">block_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double_occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">blocks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.__init__" title="Link to this definition"></a></dt>
<dd><p>Intializes the <cite>spinful_fermion_basis_general</cite> object (basis for fermionic operators).</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>L: int</strong></dt><dd><p>Length of chain/number of sites.</p>
</dd>
<dt><strong>Nf: tuple(int), optional</strong></dt><dd><p>Number of fermions in chain. Can be tupe of integers or list of tuples of integers <cite>[(Nup,Ndown),…]</cite> to specify one or more particle sectors.</p>
</dd>
<dt><strong>nf: float, optional</strong></dt><dd><p>Density of fermions in chain (fermions per site).</p>
</dd>
<dt><strong>Ns_block_est: int, optional</strong></dt><dd><p>Overwrites the internal estimate of the size of the reduced Hilbert space for the given symmetries. This can be used to help conserve memory if the exact size of the H-space is known ahead of time.</p>
</dd>
<dt><strong>simple_symm: bool, optional</strong></dt><dd><p>Flags whidh toggles the setting for the types of mappings and operator strings the basis will use. See this tutorial for more details.</p>
</dd>
<dt><strong>make_basis: bool, optional</strong></dt><dd><p>Boolean to control whether to make the basis. Allows the use to use some functionality of the basis constructor without constructing the entire basis.</p>
</dd>
<dt><strong>double_occupancy: bool, optional</strong></dt><dd><p>Boolean to toggle the presence of doubly-occupied sites (both a spin up and a spin-down fermion present on the same lattice site) in the basis. Default is <cite>double_occupancy=True</cite>, for which doubly-occupied states are present.</p>
</dd>
<dt><strong>block_order: list of strings, optional</strong></dt><dd><p>A list of strings containing the names of the symmetry blocks which specifies the order in which the symmetries will be applied to the state when calculating the basis. The first element in the list is applied to the state first followed by the second element, etc. If the list is not specificed the ordering is such that the symmetry with the largest cycle is the first, followed by the second largest, etc.</p>
</dd>
<dt><strong>**blocks: optional</strong></dt><dd><p>keyword arguments which pass the symmetry generator arrays. For instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="p">(</span><span class="o">...</span><span class="p">,</span><span class="n">kxblock</span><span class="o">=</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">q</span><span class="p">),</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>The keys of the symmetry sector, e.g. <cite>kxblock</cite>, can be chosen arbitrarily by the user. The
values are tuples where the first entry contains the symmetry transformation <span class="math notranslate nohighlight">\(Q\)</span> acting on the
lattice sites (see class example), and the second entry is an integer <span class="math notranslate nohighlight">\(q\)</span> to label the symmetry
sector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.Op" title="quspin.basis.spinful_fermion_basis_general.Op"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Op</span></code></a>(opstr, indx, J, dtype)</p></td>
<td><p>Constructs operator from a site-coupling list and an operator string in a lattice basis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.Op_bra_ket" title="quspin.basis.spinful_fermion_basis_general.Op_bra_ket"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Op_bra_ket</span></code></a>(opstr, indx, J, dtype, ket_states)</p></td>
<td><p>Finds bra states which connect given ket states by operator from a site-coupling list and an operator string.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.Op_shift_sector" title="quspin.basis.spinful_fermion_basis_general.Op_shift_sector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Op_shift_sector</span></code></a>(other_basis, op_list, v_in)</p></td>
<td><p>Applies symmetry non-conserving operator to state in symmetry-reduced basis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.__init__" title="quspin.basis.spinful_fermion_basis_general.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(N[, Nf, nf, Ns_block_est, ...])</p></td>
<td><p>Intializes the <cite>spinful_fermion_basis_general</cite> object (basis for fermionic operators).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.check_hermitian" title="quspin.basis.spinful_fermion_basis_general.check_hermitian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_hermitian</span></code></a>(static, dynamic)</p></td>
<td><p>Checks operator string lists for hermiticity of the combined operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.check_pcon" title="quspin.basis.spinful_fermion_basis_general.check_pcon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_pcon</span></code></a>(static, dynamic)</p></td>
<td><p>Checks operator string lists for particle number (magnetisation) conservartion of the combined operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.check_symm" title="quspin.basis.spinful_fermion_basis_general.check_symm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_symm</span></code></a>(static, dynamic)</p></td>
<td><p>Checks operator string lists for the required symmetries of the combined operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.ent_entropy" title="quspin.basis.spinful_fermion_basis_general.ent_entropy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ent_entropy</span></code></a>(state[, sub_sys_A, density, ...])</p></td>
<td><p>Calculates entanglement entropy of subsystem A and the corresponding reduced density matrix</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.expanded_form" title="quspin.basis.spinful_fermion_basis_general.expanded_form"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expanded_form</span></code></a>([static, dynamic])</p></td>
<td><p>Splits up operator strings containing &quot;x&quot; and &quot;y&quot; into operator combinations of &quot;+&quot; and &quot;-&quot;.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.get_amp" title="quspin.basis.spinful_fermion_basis_general.get_amp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_amp</span></code></a>(states[, out, amps, mode])</p></td>
<td><p>Computes the rescale factor of state amplitudes between the symmetry-reduced and full basis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.get_proj" title="quspin.basis.spinful_fermion_basis_general.get_proj"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_proj</span></code></a>(dtype[, pcon])</p></td>
<td><p>Calculates transformation/projector from symmetry-reduced basis to full (symmetry-free) basis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.get_vec" title="quspin.basis.spinful_fermion_basis_general.get_vec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_vec</span></code></a>(v0[, sparse, pcon])</p></td>
<td><p>DEPRECATED (cf <cite>project_from</cite>).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.index" title="quspin.basis.spinful_fermion_basis_general.index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">index</span></code></a>(up_state, down_state)</p></td>
<td><p>Finds the index of user-defined Fock state in spinful fermion basis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.inplace_Op" title="quspin.basis.spinful_fermion_basis_general.inplace_Op"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inplace_Op</span></code></a>(v_in, op_list, dtype[, ...])</p></td>
<td><p>Calculates the action of an operator on a state.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.int_to_state" title="quspin.basis.spinful_fermion_basis_general.int_to_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int_to_state</span></code></a>(state[, bracket_notation])</p></td>
<td><p>Finds string representation of a state defined in integer representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.make" title="quspin.basis.spinful_fermion_basis_general.make"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make</span></code></a>([Ns_block_est, N_p])</p></td>
<td><p>Creates the entire basis by calling the basis constructor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.make_basis_blocks" title="quspin.basis.spinful_fermion_basis_general.make_basis_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_basis_blocks</span></code></a>([N_p])</p></td>
<td><p>Creates/modifies the bounds for representatives based on prefix tages.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.normalization" title="quspin.basis.spinful_fermion_basis_general.normalization"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalization</span></code></a>(states[, out])</p></td>
<td><p>Computes normalization of <cite>basis</cite> states.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.partial_trace" title="quspin.basis.spinful_fermion_basis_general.partial_trace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">partial_trace</span></code></a>(state[, sub_sys_A, ...])</p></td>
<td><p>Calculates reduced density matrix, through a partial trace of a quantum state in a lattice <cite>basis</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.project_from" title="quspin.basis.spinful_fermion_basis_general.project_from"><code class="xref py py-obj docutils literal notranslate"><span class="pre">project_from</span></code></a>(v0[, sparse, pcon])</p></td>
<td><p>Transforms state from symmetry-reduced basis to full (symmetry-free) basis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.project_to" title="quspin.basis.spinful_fermion_basis_general.project_to"><code class="xref py py-obj docutils literal notranslate"><span class="pre">project_to</span></code></a>(v0[, sparse, pcon])</p></td>
<td><p>Transforms state from full (symmetry-free) basis to symmetry-reduced basis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.representative" title="quspin.basis.spinful_fermion_basis_general.representative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">representative</span></code></a>(states[, out, return_g, ...])</p></td>
<td><p>Maps states to their representatives under the <cite>basis</cite> symmetries.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.state_to_int" title="quspin.basis.spinful_fermion_basis_general.state_to_int"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_to_int</span></code></a>(state)</p></td>
<td><p>Finds integer representation of a state defined in string format.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.N" title="quspin.basis.spinful_fermion_basis_general.N"><code class="xref py py-obj docutils literal notranslate"><span class="pre">N</span></code></a></p></td>
<td><p>number of sites the basis is constructed with.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.Ns" title="quspin.basis.spinful_fermion_basis_general.Ns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Ns</span></code></a></p></td>
<td><p>number of states in the Hilbert space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.blocks" title="quspin.basis.spinful_fermion_basis_general.blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">blocks</span></code></a></p></td>
<td><p>contains the quantum numbers (blocks) for the symmetry sectors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.description" title="quspin.basis.spinful_fermion_basis_general.description"><code class="xref py py-obj docutils literal notranslate"><span class="pre">description</span></code></a></p></td>
<td><p>information about <cite>basis</cite> object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.dtype" title="quspin.basis.spinful_fermion_basis_general.dtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></a></p></td>
<td><p>data type of basis state integers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.noncommuting_bits" title="quspin.basis.spinful_fermion_basis_general.noncommuting_bits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">noncommuting_bits</span></code></a></p></td>
<td><p>list of bits that represent sites that do not commute along with the phase required from commuting sites</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.operators" title="quspin.basis.spinful_fermion_basis_general.operators"><code class="xref py py-obj docutils literal notranslate"><span class="pre">operators</span></code></a></p></td>
<td><p>set of available operator strings.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.sps" title="quspin.basis.spinful_fermion_basis_general.sps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sps</span></code></a></p></td>
<td><p>number of states per site (ie, the on-site Hilbert space dimension).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#quspin.basis.spinful_fermion_basis_general.states" title="quspin.basis.spinful_fermion_basis_general.states"><code class="xref py py-obj docutils literal notranslate"><span class="pre">states</span></code></a></p></td>
<td><p>basis states stored in their integer representation.</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.N">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">N</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.N" title="Link to this definition"></a></dt>
<dd><p>number of sites the basis is constructed with.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.Ns">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Ns</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.Ns" title="Link to this definition"></a></dt>
<dd><p>number of states in the Hilbert space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.Op">
<span class="sig-name descname"><span class="pre">Op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.Op" title="Link to this definition"></a></dt>
<dd><p>Constructs operator from a site-coupling list and an operator string in a lattice basis.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>opstr</strong><span class="classifier">str</span></dt><dd><p>Operator string in the lattice basis format. For instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">opstr</span> <span class="o">=</span> <span class="s2">&quot;zz&quot;</span>
</pre></div>
</div>
</dd>
<dt><strong>indx</strong><span class="classifier">list(int)</span></dt><dd><p>List of integers to designate the sites the lattice basis operator is defined on. For instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><strong>J</strong><span class="classifier">scalar</span></dt><dd><p>Coupling strength.</p>
</dd>
<dt><strong>dtype</strong><span class="classifier">‘type’</span></dt><dd><p>Data type (e.g. numpy.float64) to construct the operator with.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple</dt><dd><dl class="simple">
<dt><cite>(ME,row,col)</cite>, where</dt><dd><ul class="simple">
<li><p>numpy.ndarray(scalar): <cite>ME</cite>: matrix elements of type <cite>dtype</cite>.</p></li>
<li><dl class="simple">
<dt>numpy.ndarray(int): <cite>row</cite>: row indices of matrix representing the operator in the lattice basis,</dt><dd><p>such that <cite>row[i]</cite> is the row index of <cite>ME[i]</cite>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>numpy.ndarray(int): <cite>col</cite>: column index of matrix representing the operator in the lattice basis,</dt><dd><p>such that <cite>col[i]</cite> is the column index of <cite>ME[i]</cite>.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">J</span> <span class="o">=</span> <span class="mf">1.41</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opstr</span> <span class="o">=</span> <span class="s2">&quot;zz&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ME</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">Op</span><span class="p">(</span><span class="n">opstr</span><span class="p">,</span><span class="n">indx</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.Op_bra_ket">
<span class="sig-name descname"><span class="pre">Op_bra_ket</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ket_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general.Op_bra_ket"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.Op_bra_ket" title="Link to this definition"></a></dt>
<dd><p>Finds bra states which connect given ket states by operator from a site-coupling list and an operator string.</p>
<p>Given a set of ket states <span class="math notranslate nohighlight">\(|s\rangle\)</span>, the function returns the bra states <span class="math notranslate nohighlight">\(\langle s'|\)</span> which connect to them through an operator, together with the corresponding matrix elements.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>opstr</strong><span class="classifier">str</span></dt><dd><p>Operator string in the lattice basis format. For instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">opstr</span> <span class="o">=</span> <span class="s2">&quot;zz&quot;</span>
</pre></div>
</div>
</dd>
<dt><strong>indx</strong><span class="classifier">list(int)</span></dt><dd><p>List of integers to designate the sites the lattice basis operator is defined on. For instance:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><strong>J</strong><span class="classifier">scalar</span></dt><dd><p>Coupling strength.</p>
</dd>
<dt><strong>dtype</strong><span class="classifier">‘type’</span></dt><dd><p>Data type (e.g. numpy.float64) to construct the matrix elements with.</p>
</dd>
<dt><strong>ket_states</strong><span class="classifier">numpy.ndarray(int)</span></dt><dd><p>Ket states in integer representation. Must be of same data type as <cite>basis</cite>.</p>
</dd>
<dt><strong>reduce_output: bool, optional</strong></dt><dd><p>If set to <cite>False</cite>, the returned arrays have the same size as <cite>ket_states</cite>; If set to <cite>True</cite> zeros are purged.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple</dt><dd><dl class="simple">
<dt><cite>(ME,bra,ket)</cite>, where</dt><dd><ul class="simple">
<li><p>numpy.ndarray(scalar): <cite>ME</cite>: matrix elements of type <cite>dtype</cite>, which connects the ket and bra states.</p></li>
<li><dl class="simple">
<dt>numpy.ndarray(int): <cite>bra</cite>: bra states, obtained by applying the matrix representing the operator in the lattice basis,</dt><dd><p>to the ket states, such that <cite>bra[i]</cite> corresponds to <cite>ME[i]</cite> and connects to <cite>ket[i]</cite>.</p>
</dd>
</dl>
</li>
<li><p>numpy.ndarray(int): <cite>ket</cite>: ket states, such that <cite>ket[i]</cite> corresponds to <cite>ME[i]</cite> and connects to <cite>bra[i]</cite>.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Similar to <cite>Op</cite> but instead of returning the matrix indices (row,col), it returns the states (bra,ket) in integer representation.</p></li>
<li><p>Does NOT require the full basis (see <cite>basis</cite> optional argument <cite>make_basis</cite>).</p></li>
<li><p>If a state from <cite>ket_states</cite> does not have a non-zero matrix element, it is removed from the returned list. See otional argument <cite>reduce_output</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">J</span> <span class="o">=</span> <span class="mf">1.41</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opstr</span> <span class="o">=</span> <span class="s2">&quot;zz&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ME</span><span class="p">,</span> <span class="n">bra</span><span class="p">,</span> <span class="n">ket</span> <span class="o">=</span> <span class="n">Op_bra_ket</span><span class="p">(</span><span class="n">opstr</span><span class="p">,</span><span class="n">indx</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">dtype</span><span class="p">,</span><span class="n">ket_states</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.Op_shift_sector">
<span class="sig-name descname"><span class="pre">Op_shift_sector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other_basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general.Op_shift_sector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.Op_shift_sector" title="Link to this definition"></a></dt>
<dd><p>Applies symmetry non-conserving operator to state in symmetry-reduced basis.</p>
<p>An operator, which does not conserve a symmetry, induces a change in the quantum number of a state defined in the corresponding symmetry sector. Hence, when the operator is applied on a quantum state, the state shifts the symmetry sector. <cite>Op_shift_sector()</cite> handles this automatically.</p>
<p><span class="red">NOTE: One has to make sure that (i) the operator moves the state between the two sectors, and (ii) the two bases objects have the same symmetries. This function will not give the correct results otherwise.</span></p>
<p>Formally  equivalent to:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P1</span> <span class="o">=</span> <span class="n">basis_sector_1</span><span class="o">.</span><span class="n">get_proj</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="c1"># projector between full and initial basis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P2</span> <span class="o">=</span> <span class="n">basis_sector_2</span><span class="o">.</span><span class="n">get_proj</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="c1"># projector between full and target basis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_in_full</span> <span class="o">=</span> <span class="n">P1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v_in</span><span class="p">)</span> <span class="c1"># go from initial basis to to full basis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_out_full</span> <span class="o">=</span> <span class="n">basis_full</span><span class="o">.</span><span class="n">inplace_Op</span><span class="p">(</span><span class="n">v_in_full</span><span class="p">,</span><span class="n">op_list</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="c1"># apply Op</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v_out</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v_out_full</span><span class="p">)</span> <span class="c1"># project to target basis</span>
</pre></div>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>other_basis</strong><span class="classifier"><cite>basis</cite> object</span></dt><dd><p><cite>basis_general</cite> object for the initial symmetry sector. Must be the same <cite>basis</cite> class type as the basis whose instance is <cite>Op_shift_sector()</cite> (i.e. the basis in <cite>basis.Op_shift_sector()</cite>).</p>
</dd>
<dt><strong>op_list</strong><span class="classifier">list</span></dt><dd><p>Operator string list which defines the operator to apply. Follows the format <cite>[[“z”,[i],Jz[i]] for i in range(L)], [“x”,[i],Jx[j]] for j in range(L)],…]</cite>.</p>
</dd>
<dt><strong>v_in</strong><span class="classifier">array_like, (other_basis.Ns,…)</span></dt><dd><p>Initial state to apply the symmetry non-conserving operator on. Must have the same length as <cite>other_basis.Ns</cite>.</p>
</dd>
<dt><strong>v_out</strong><span class="classifier">array_like, (basis.Ns,…), optional</span></dt><dd><p>Optional array to write the result for the final/target state in.</p>
</dd>
<dt><strong>dtype</strong><span class="classifier">numpy dtype for matrix elements, optional</span></dt><dd><p>Data type (e.g. <cite>numpy.float64</cite>) to construct the operator with.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>(basis.Ns, ) numpy.ndarray</dt><dd><p>Array containing the state <cite>v_out</cite> in the current basis, i.e. the basis in <cite>basis.Op_shift_sector()</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>particularly useful when computing correlation functions.</p></li>
<li><p>supports parallelization to multiple states listed in the columns of <cite>v_in</cite>.</p></li>
<li><p>the user is strongly advised to use the code under “Formally equivalent” above to check the results of this function for small system sizes.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_out</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">Op_shift_sector</span><span class="p">(</span><span class="n">initial_basis</span><span class="p">,</span> <span class="n">op_list</span><span class="p">,</span> <span class="n">v_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v_out</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">basis</span><span class="o">.</span><span class="n">Ns</span><span class="p">,</span> <span class="n">v_in</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">initial_basis</span><span class="o">.</span><span class="n">Ns</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.blocks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">blocks</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.blocks" title="Link to this definition"></a></dt>
<dd><p>contains the quantum numbers (blocks) for the symmetry sectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.check_hermitian">
<span class="sig-name descname"><span class="pre">check_hermitian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">static</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.check_hermitian" title="Link to this definition"></a></dt>
<dd><p>Checks operator string lists for hermiticity of the combined operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>static: list</strong></dt><dd><p>Static operators formatted to be passed into the static argument of the <cite>hamiltonian</cite> class.</p>
</dd>
<dt><strong>dynamic: list</strong></dt><dd><p>Dynamic operators formatted to be passed into the dynamic argument of the <cite>hamiltonian</cite> class.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.check_pcon">
<span class="sig-name descname"><span class="pre">check_pcon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">static</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.check_pcon" title="Link to this definition"></a></dt>
<dd><p>Checks operator string lists for particle number (magnetisation) conservartion of the combined operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>static: list</strong></dt><dd><p>Static operators formatted to be passed into the static argument of the <cite>hamiltonian</cite> class.</p>
</dd>
<dt><strong>dynamic: list</strong></dt><dd><p>Dynamic operators formatted to be passed into the dynamic argument of the <cite>hamiltonian</cite> class.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.check_symm">
<span class="sig-name descname"><span class="pre">check_symm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">static</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.check_symm" title="Link to this definition"></a></dt>
<dd><p>Checks operator string lists for the required symmetries of the combined operator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>static: list</strong></dt><dd><p>Static operators formatted to be passed into the static argument of the <cite>hamiltonian</cite> class.</p>
</dd>
<dt><strong>dynamic: list</strong></dt><dd><p>Dynamic operators formatted to be passed into the dynamic argument of the <cite>hamiltonian</cite> class.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.description">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">description</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.description" title="Link to this definition"></a></dt>
<dd><p>information about <cite>basis</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.dtype" title="Link to this definition"></a></dt>
<dd><p>data type of basis state integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.dtype</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.ent_entropy">
<span class="sig-name descname"><span class="pre">ent_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_sys_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsys_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_rdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_pure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_rdm_EVs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svd_solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general.ent_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.ent_entropy" title="Link to this definition"></a></dt>
<dd><p>Calculates entanglement entropy of subsystem A and the corresponding reduced density matrix</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>state</strong><span class="classifier">obj</span></dt><dd><p>State of the quantum system. Can be either one of:</p>
<blockquote>
<div><ul class="simple">
<li><p>numpy.ndarray [shape (Ns,)]: pure state (default).</p></li>
<li><p>numpy.ndarray [shape (Ns,Ns)]: density matrix (DM).</p></li>
<li><p>dict(‘V_states’,V_states) [shape (Ns,Nvecs)]: collection of <cite>Nvecs</cite> states stored in the columns of <cite>V_states</cite>.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>sub_sys_A</strong><span class="classifier">tuple/list, optional</span></dt><dd><p>Defines the sites contained in subsystem A [by python convention the first site of the chain is labelled j=0]. Depending on the usage of simple/advanced notations the input is different:</p>
<blockquote>
<div><ul class="simple">
<li><p>Simple notation: The format is <cite>(spin_up_subsys,spin_down_subsys)</cite> where the tuple <cite>spin_up_subsys</cite> and <cite>spin_down_subsys</cite> are lists (see example below).  Default is <cite>tuple(range(N//2),range(N//2))</cite> with <cite>N</cite> the number of physical lattice sites (e.g. sites which both species of fermions can occupy).</p></li>
<li><p>Advanced notation: The format is a list, the labeling of the up spins are sites <cite>0 - (N-1)</cite> while the down spins are on sites <cite>N - (2N - 1)</cite>.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>return_rdm</strong><span class="classifier">str, optional</span></dt><dd><p>Toggles returning the reduced DM. Can be tierh one of:</p>
<blockquote>
<div><ul class="simple">
<li><p>“A”: returns reduced DM of subsystem A.</p></li>
<li><p>“B”: returns reduced DM of subsystem B.</p></li>
<li><p>“both”: returns reduced DM of both A and B subsystems.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>enforce_pure</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to assume <cite>state</cite> is a colelction of pure states or a mixed density matrix, if
it is a square array. Default is <cite>False</cite>.</p>
</dd>
<dt><strong>subsys_ordering</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to reorder the sites in <cite>sub_sys_A</cite> in ascending order. Default is <cite>True</cite>.</p>
</dd>
<dt><strong>sparse</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return a sparse DM. Default is <cite>False</cite>.</p>
</dd>
<dt><strong>return_rdm_EVs</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return the eigenvalues of rthe educed DM. If <cite>return_rdm</cite> is specified,
the eigenvalues of the corresponding DM are returned. If <cite>return_rdm</cite> is NOT specified,
the spectrum of <cite>rdm_A</cite> is returned by default. Default is <cite>False</cite>.</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float, optional</span></dt><dd><p>Renyi <span class="math notranslate nohighlight">\(\alpha\)</span> parameter for the entanglement entropy. Default is <span class="math notranslate nohighlight">\(\alpha=1\)</span>:</p>
<div class="math notranslate nohighlight">
\[S_\mathrm{ent}(\alpha) =  \frac{1}{1-\alpha}\log \mathrm{tr}_{A} \left( \mathrm{tr}_{A^c} \vert\psi\rangle\langle\psi\vert \right)^\alpha\]</div>
<p><strong>Note:</strong> The logarithm used is the natural logarithm (base e).</p>
</dd>
<dt><strong>sparse_diag</strong><span class="classifier">bool, optional</span></dt><dd><p>When <cite>sparse=True</cite>, this flag enforces the use of
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.eigsh.html">scipy.sparse.linalg.eigsh()</a>
to calculate the eigenvaues of the reduced DM.</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int, optional</span></dt><dd><p>Specifies the number of iterations for Lanczos diagonalisation. Look up documentation for
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.eigsh.html">scipy.sparse.linalg.eigsh()</a>.</p>
</dd>
<dt><strong>svd_solver</strong><span class="classifier">object, optional</span></dt><dd><p>Specifies the svd solver to be used, e.g. <cite>numpy.linalg.svd</cite> or <cite>scipy.linalg.svd</cite>, or a custom solver. Effective when <cite>enforce_pure=True</cite> or <cite>sparse=False</cite>.</p>
</dd>
<dt><strong>svd_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Specifies additional arguments for <cite>svd_solver</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>dict</dt><dd><dl class="simple">
<dt>Dictionary with following keys, depending on input parameters:</dt><dd><ul class="simple">
<li><p>“Sent_A”: entanglement entropy of subsystem A (default).</p></li>
<li><p>“Sent_B”: entanglement entropy of subsystem B.</p></li>
<li><p>“p_A”: singular values of reduced DM of subsystem A (default).</p></li>
<li><p>“p_B”: singular values of reduced DM of subsystem B.</p></li>
<li><p>“rdm_A”: reduced DM of subsystem A.</p></li>
<li><p>“rdm_B”: reduced DM of subsystem B.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Algorithm is based on both partial tracing and sigular value decomposition (SVD), optimised for speed.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sub_sys_A_up</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">L</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># subsystem for spin-up fermions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub_sys_A_down</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">L</span><span class="o">//</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># subsystem for spin-down fermions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsys_A</span><span class="o">=</span><span class="p">(</span><span class="n">sub_sys_A_up</span><span class="p">,</span><span class="n">sub_sys_A_down</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">Ns</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">Ns</span><span class="p">)</span> <span class="c1"># infinite temperature state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ent_entropy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">sub_sys_A</span><span class="o">=</span><span class="n">subsys_A</span><span class="p">,</span><span class="n">return_rdm</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="n">enforce_pure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">return_rdm_EVs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                            <span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">sparse_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">subsys_ordering</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.expanded_form">
<span class="sig-name descname"><span class="pre">expanded_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">static</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.expanded_form" title="Link to this definition"></a></dt>
<dd><p>Splits up operator strings containing “x” and “y” into operator combinations of “+” and “-”. This function is useful for higher spin hamiltonians where “x” and “y” operators are not appropriate operators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>static: list</strong></dt><dd><p>Static operators formatted to be passed into the static argument of the <cite>hamiltonian</cite> class.</p>
</dd>
<dt><strong>dynamic: list</strong></dt><dd><p>Dynamic operators formatted to be passed into the dynamic argument of the <cite>hamiltonian</cite> class.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple</dt><dd><dl class="simple">
<dt><cite>(static, dynamic)</cite>, where</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>list: <cite>static</cite>: operator strings with “x” and “y” expanded into “+” and “-”, formatted to</dt><dd><p>be passed into the static argument of the <cite>hamiltonian</cite> class.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>list: <cite>dynamic</cite>: operator strings with “x” and “y” expanded into “+” and “-”, formatted to</dt><dd><p>be passed into the dynamic argument of the <cite>hamiltonian</cite> class.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function works with the <cite>tensor_basis</cite> and other basis which use the “|” symbol in the opstr.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">static</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;xx&quot;</span><span class="p">,[[</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]],[</span><span class="s2">&quot;yy&quot;</span><span class="p">,[[</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dynamic</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;y&quot;</span><span class="p">,[[</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">,[]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expanded_form</span><span class="p">(</span><span class="n">static</span><span class="p">,</span><span class="n">dynamic</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.get_amp">
<span class="sig-name descname"><span class="pre">get_amp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'representative'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.get_amp" title="Link to this definition"></a></dt>
<dd><p>Computes the rescale factor of state amplitudes between the symmetry-reduced and full basis.</p>
<p>Given a quantum state <span class="math notranslate nohighlight">\(s\)</span> and a state amplitude in the full basis <span class="math notranslate nohighlight">\(\psi_s\)</span>, its representative (under the symemtries)
<span class="math notranslate nohighlight">\(r(s)\)</span> with a corresponding amplitude <span class="math notranslate nohighlight">\(\psi^\text{sym}_r\)</span>, the function computes the ratio <span class="math notranslate nohighlight">\(C\)</span>, defined as</p>
<div class="math notranslate nohighlight">
\[\psi_s = C\psi_r^\text{sym}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>states</strong><span class="classifier">array_like(int)</span></dt><dd><p>Fock-basis (z-basis) states to find the amplitude rescale factor <span class="math notranslate nohighlight">\(C\)</span> of. States are stored in integer representations.</p>
</dd>
<dt><strong>out</strong><span class="classifier">numpy.ndarray(float), optional</span></dt><dd><p>variable to store the rescale factors <span class="math notranslate nohighlight">\(C\)</span> of the states in. Must be a real or complex-valued <cite>numpy.ndarray</cite> of the same shape as <cite>states</cite>.</p>
</dd>
<dt><strong>amps</strong><span class="classifier">numpy.ndarray(float), optional</span></dt><dd><p>array of amplitudes to rescale by the amplitude factor <span class="math notranslate nohighlight">\(C\)</span> (see <cite>mode</cite>). Updated in-place. Must be a real or complex-valued <cite>numpy.ndarray</cite> of the same shape as <cite>states</cite>.</p>
</dd>
<dt><strong>mode</strong><span class="classifier">string, optional</span></dt><dd><ul class="simple">
<li><dl class="simple">
<dt>if <cite>mode=’representative’</cite> (default), then the function assumes that</dt><dd><ol class="lowerroman simple">
<li><p><cite>states</cite> already contains representatives (i.e. states in the symmetry-reduced basis);</p></li>
<li><p><cite>amps</cite> (if passed) are amplitudes in the symmetry-reduced basis (<span class="math notranslate nohighlight">\(\psi_r^\text{symm}\)</span>). The function will update <cite>amps</cite> in-place to <span class="math notranslate nohighlight">\(\psi_s\)</span>.</p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>if <cite>mode=’full_basis’</cite>, then the function assumes that</dt><dd><ol class="lowerroman simple">
<li><p><cite>states</cite> contains full-basis states (the funciton will compute the corresponding representatives);</p></li>
<li><dl class="simple">
<dt><cite>amps</cite> (if passed) are amplitudes in the full basis (<span class="math notranslate nohighlight">\(\psi_s\)</span>). The function will update <cite>amps</cite> in-place to <span class="math notranslate nohighlight">\(\psi_r^\text{symm}\)</span>;</dt><dd><p><strong>Note</strong>: the function will also update the variable <cite>states</cite> in place with the corresponding representatives.</p>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array_like(float)</dt><dd><p>amplitude rescale factor <span class="math notranslate nohighlight">\(C\)</span> (see expression above).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Particularly useful when a given operation cannot be carried away in the symmetry-reduced basis in a straightforward manner.</p></li>
<li><p>To transform an entire state from a symmetry-reduced basis to the full (symmetry-free) basis, use the <cite>basis.get_vec()</cite> function.</p></li>
<li><p>Returns zero, if the state passed to the function is not part of the symmetry-reduced basis.</p></li>
<li><p>If <cite>amps</cite> is passed, the user has to make sure that the input data in <cite>amps</cite> correspond to the <cite>states</cite>.</p></li>
<li><p>The function assumes that <cite>states</cite> comply with the particle conservation symmetry the <cite>basis</cite> was constructed with.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">get_amp</span><span class="p">(</span><span class="n">states</span><span class="p">,</span><span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">amps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;representative&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.get_proj">
<span class="sig-name descname"><span class="pre">get_proj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.get_proj" title="Link to this definition"></a></dt>
<dd><p>Calculates transformation/projector from symmetry-reduced basis to full (symmetry-free) basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dtype</strong><span class="classifier">‘type’</span></dt><dd><p>Data type (e.g. numpy.float64) to construct the projector with.</p>
</dd>
<dt><strong>pcon</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return the projector to the particle number (magnetisation) conserving basis
(useful in bosonic/single particle systems). Default is <cite>pcon=False</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>scipy.sparse.csc_matrix</dt><dd><p>Transformation/projector between the symmetry-reduced and the full basis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>particularly useful when a given operation canot be carried out in the symmetry-reduced basis in a straightforward manner.</p></li>
<li><p>see also <cite>Op_shift_sector()</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span> <span class="o">=</span> <span class="n">get_proj</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span><span class="n">pcon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.get_vec">
<span class="sig-name descname"><span class="pre">get_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.get_vec" title="Link to this definition"></a></dt>
<dd><p>DEPRECATED (cf <cite>project_from</cite>). Transforms state from symmetry-reduced basis to full (symmetry-free) basis.</p>
<p class="rubric">Notes</p>
<p>This function is <span class="red">deprecated</span>. Use <cite>project_from()</cite> instead; see also the inverse function <cite>project_to()</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">up_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">down_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general.index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.index" title="Link to this definition"></a></dt>
<dd><p>Finds the index of user-defined Fock state in spinful fermion basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>up_state</strong><span class="classifier">str</span></dt><dd><p>string which define the Fock state for the spin up fermions.</p>
</dd>
<dt><strong>down_state</strong><span class="classifier">str</span></dt><dd><p>string which define the Fock state for the spin down fermions.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Position of the Fock state in the <cite>spinful_fermion_basis_1d</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Particularly useful for defining initial Fock states through a unit vector in the direction specified
by <cite>index()</cite>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s_up</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;1&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_down</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;1&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span> <span class="n">basis</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">s_up</span><span class="p">,</span><span class="n">s_down</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.inplace_Op">
<span class="sig-name descname"><span class="pre">inplace_Op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transposed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conjugated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.inplace_Op" title="Link to this definition"></a></dt>
<dd><p>Calculates the action of an operator on a state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>v_in</strong><span class="classifier">array_like</span></dt><dd><p>state (or states stored in columns) to act on with the operator.</p>
</dd>
<dt><strong>op_list</strong><span class="classifier">list</span></dt><dd><p>Operator string list which defines the operator to apply. Follows the format <cite>[[“z”,[i],Jz[i]] for i in range(L)], [“x”,[i],Jx[j]] for j in range(L)],…]</cite>.</p>
</dd>
<dt><strong>dtype</strong><span class="classifier">‘type’</span></dt><dd><p>Data type (e.g. <cite>numpy.float64</cite>) to construct the operator with.</p>
</dd>
<dt><strong>transposed</strong><span class="classifier">bool, optional</span></dt><dd><p>if <cite>True</cite> this function will act with the trasposed operator.</p>
</dd>
<dt><strong>conjugated</strong><span class="classifier">bool, optional</span></dt><dd><p>if <cite>True</cite> this function will act with the conjugated operator.</p>
</dd>
<dt><strong>a</strong><span class="classifier">scalar, optional</span></dt><dd><p>value to rescale resulting vector after performing the action of the operators. Same as rescaling all couplings by value a.</p>
</dd>
<dt><strong>v_out</strong><span class="classifier">array_like</span></dt><dd><p>output array, must be the same shape as <cite>v_in</cite> and must match the type of the output.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><ul class="simple">
<li><p>if <cite>v_out</cite> is not <cite>None</cite>, this function modifies <cite>v_out</cite> inplace and returns it.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function works with the <cite>tensor_basis</cite> and other basis which use the “|” symbol in the opstr.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">J</span> <span class="o">=</span> <span class="mf">1.41</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">opstr</span> <span class="o">=</span> <span class="s2">&quot;zz&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">op_list</span><span class="o">=</span><span class="p">[[</span><span class="n">opstr</span><span class="p">,</span><span class="n">indx</span><span class="p">,</span><span class="n">J</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ME</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">inplace_Op</span><span class="p">(</span><span class="n">op_list</span><span class="p">,</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.int_to_state">
<span class="sig-name descname"><span class="pre">int_to_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bracket_notation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general.int_to_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.int_to_state" title="Link to this definition"></a></dt>
<dd><p>Finds string representation of a state defined in integer representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>state</strong><span class="classifier">int</span></dt><dd><p>Defines the Fock state in integer representation in underlying lattice <cite>basis</cite>.</p>
</dd>
<dt><strong>bracket_notation</strong><span class="classifier">bool, optional</span></dt><dd><p>Toggles whether to return the state in <cite>|str&gt;</cite> notation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>str</dt><dd><p>String corresponding to the Fock <cite>state</cite> in the lattice basis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is the inverse of <cite>state_to_int</cite>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">basis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># pick state from basis set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_str</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">int_to_state</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s_str</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.make">
<span class="sig-name descname"><span class="pre">make</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ns_block_est</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.make" title="Link to this definition"></a></dt>
<dd><p>Creates the entire basis by calling the basis constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Ns_block_est: int, optional</strong></dt><dd><p>Overwrites the internal estimate of the size of the reduced Hilbert space for the given symmetries. This can be used to help conserve memory if the exact size of the H-space is known ahead of time.</p>
</dd>
<dt><strong>N_p: int, optional</strong></dt><dd><p>number of bits to use in the prefix label used to generate blocks for searching positions of representatives.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Total number of states in the (symmetry-reduced) Hilbert space.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The memory stored in the basis grows exponentially as exactly <span class="math notranslate nohighlight">\(2^{N_p+1}\)</span>. The default behavior is to use <cite>N_p</cite> such that
the size of the stored information for the representative bounds is approximately as large as the basis. This is not as effective
for basis which small particle numbers as the blocks have very uneven sizes. To not use the blocks just set N_p=0.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="p">,</span> <span class="n">Nup</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">=</span><span class="n">spin_basis_general</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Nup</span><span class="o">=</span><span class="n">Nup</span><span class="p">,</span><span class="n">make_basis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.make_basis_blocks">
<span class="sig-name descname"><span class="pre">make_basis_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.make_basis_blocks" title="Link to this definition"></a></dt>
<dd><p>Creates/modifies the bounds for representatives based on prefix tages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N_p: int, optional</strong></dt><dd><p>number of bits to use in the prefix label used to generate blocks for searching positions of representatives.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The memory stored in the basis grows exponentially as exactly <span class="math notranslate nohighlight">\(2^{N_p+1}\)</span>. The default behavior is to use <cite>N_p</cite> such that
the size of the stored information for the representative bounds is approximately as large as the basis. This is not as effective
for basis which small particle numbers as the blocks have very uneven sizes. To not use the blocks just set N_p=0.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="p">,</span> <span class="n">Nup</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">=</span><span class="n">spin_basis_general</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Nup</span><span class="o">=</span><span class="n">Nup</span><span class="p">,</span><span class="n">make_basis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.noncommuting_bits">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">noncommuting_bits</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.noncommuting_bits" title="Link to this definition"></a></dt>
<dd><p>list of bits that represent sites that do not commute along with the phase required from commuting sites</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.normalization">
<span class="sig-name descname"><span class="pre">normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.normalization" title="Link to this definition"></a></dt>
<dd><p>Computes normalization of <cite>basis</cite> states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>states</strong><span class="classifier">array_like(int)</span></dt><dd><p>Fock-basis (z-basis) states to find the normalizations of. States are stored in integer representations.</p>
</dd>
<dt><strong>out</strong><span class="classifier">numpy.ndarray(unsigned int), optional</span></dt><dd><p>variable to store the normalizations of the states in. Must be a <cite>numpy.ndarray</cite> of datatype <cite>unsigned int</cite> (e.g. <cite>numpy.uint16</cite>), and same shape as <cite>states</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array_like(int)</dt><dd><p>normalizations of <cite>states</cite> for the given (symmetry-reduced) <cite>basis</cite>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Returns zero, if the state is not part of the symmetry-reduced basis.</p></li>
<li><p>The normalizations can be used to compute matrix elements in the symmetry-reduced basis.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">=</span><span class="n">spin_basis_general</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Nup</span><span class="o">=</span><span class="n">Nup</span><span class="p">,</span><span class="n">make_basis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="mi">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm_s</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">normalization</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">norm_s</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.operators">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">operators</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.operators" title="Link to this definition"></a></dt>
<dd><p>set of available operator strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.partial_trace">
<span class="sig-name descname"><span class="pre">partial_trace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_sys_A</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsys_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_rdm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_pure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.partial_trace" title="Link to this definition"></a></dt>
<dd><p>Calculates reduced density matrix, through a partial trace of a quantum state in a lattice <cite>basis</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>state</strong><span class="classifier">obj</span></dt><dd><p>State of the quantum system. Can be either one of:</p>
<blockquote>
<div><ul class="simple">
<li><p>numpy.ndarray [shape (Ns,)]: pure state (default).</p></li>
<li><p>numpy.ndarray [shape (Ns,Ns)]: density matrix (DM).</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>sub_sys_A</strong><span class="classifier">tuple/list, optional</span></dt><dd><p>Defines the sites contained in subsystem A [by python convention the first site of the chain is labelled j=0].
Default is <cite>tuple(range(N//2))</cite> with <cite>N</cite> the number of lattice sites.</p>
</dd>
<dt><strong>return_rdm</strong><span class="classifier">str, optional</span></dt><dd><p>Toggles returning the reduced DM. Can be tierh one of:</p>
<blockquote>
<div><ul class="simple">
<li><p>“A”: returns reduced DM of subsystem A.</p></li>
<li><p>“B”: returns reduced DM of subsystem B.</p></li>
<li><p>“both”: returns reduced DM of both A and B subsystems.</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>subsys_ordering</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to reorder the sites in <cite>sub_sys_A</cite> in ascending order. Default is <cite>True</cite>.</p>
</dd>
<dt><strong>enforce_pure</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to assume <cite>state</cite> is a colelction of pure states or a mixed density matrix, if
it is a square array. Default is <cite>False</cite>.</p>
</dd>
<dt><strong>sparse</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return a sparse DM. Default is <cite>False</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Density matrix associated with <cite>state</cite>. Depends on optional arguments.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="simple">
<dt>This function can also be applied to trace out operators/observables defined by the input <cite>state</cite>, in which case one has to additionally normalize the final output by the Hilbert space dimension of the traced-out space. However, if an operator is defined in a symmetry-reduced basis, there is a <span class="red">caveat</span>. In such a case, one has to:</dt><dd><ol class="arabic simple">
<li><p>use the <cite>basis.get_proj()</cite> function to lift the operator to the full basis;</p></li>
<li><p>apply <cite>basis.partial_trace()</cite>;</p></li>
<li><p>repeat this procedure for all symmetry sectors, and sum up the resulting reduced operators [this is becauce one has to add in the information about how the operator acts on the full Hilbert space].</p></li>
</ol>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">partial_trace</span><span class="p">(</span><span class="n">state</span><span class="p">,</span><span class="n">sub_sys_A</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">basis</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span><span class="n">return_rdm</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="n">enforce_pure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">subsys_ordering</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.project_from">
<span class="sig-name descname"><span class="pre">project_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.project_from" title="Link to this definition"></a></dt>
<dd><p>Transforms state from symmetry-reduced basis to full (symmetry-free) basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>v0</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Contains in its columns the states in the symmetry-reduced basis.</p>
</dd>
<dt><strong>sparse</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not the output should be in sparse format. Default is <cite>True</cite>.</p>
</dd>
<dt><strong>pcon</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return the output in the particle number (magnetisation) conserving basis
(useful in bosonic/single particle systems). Default is <cite>pcon=False</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Array containing the state <cite>v0</cite> in the full basis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>particularly useful when a given operation cannot be carried out in the symmetry-reduced basis in a straightforward manner.</p></li>
<li><p>supports parallelisation to multiple states listed in the columns.</p></li>
<li><p>inverse function to <cite>project_to</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_full</span> <span class="o">=</span> <span class="n">project_from</span><span class="p">(</span><span class="n">v0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v_full</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">v0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.project_to">
<span class="sig-name descname"><span class="pre">project_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.project_to" title="Link to this definition"></a></dt>
<dd><p>Transforms state from full (symmetry-free) basis to symmetry-reduced basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>v0</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Contains in its columns the states in the full (symmetry-free) basis.</p>
</dd>
<dt><strong>sparse</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not the output should be in sparse format. Default is <cite>True</cite>.</p>
</dd>
<dt><strong>pcon</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether or not to return the output in the particle number (magnetisation) conserving basis
(useful in bosonic/single particle systems). Default is <cite>pcon=False</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Array containing the state <cite>v0</cite> in the symmetry-reduced basis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>particularly useful when a given operation cannot be carried out in the full basis.</p></li>
<li><p>supports parallelisation to multiple states listed in the columns.</p></li>
<li><p>inverse function to <cite>project_from</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v_symm</span> <span class="o">=</span> <span class="n">project_to</span><span class="p">(</span><span class="n">v0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v_symm</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">v0</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.representative">
<span class="sig-name descname"><span class="pre">representative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_g</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.representative" title="Link to this definition"></a></dt>
<dd><p>Maps states to their representatives under the <cite>basis</cite> symmetries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>states</strong><span class="classifier">array_like(int)</span></dt><dd><p>Fock-basis (z-basis) states to find the representatives of. States are stored in integer representations.</p>
</dd>
<dt><strong>out</strong><span class="classifier">numpy.ndarray(int), optional</span></dt><dd><p>variable to store the representative states in. Must be a <cite>numpy.ndarray</cite> of same datatype as <cite>basis</cite>, and same shape as <cite>states</cite>.</p>
</dd>
<dt><strong>return_g</strong><span class="classifier">bool, optional</span></dt><dd><p>if set to <cite>True</cite>, the function also returns the integer <cite>g</cite> corresponding to the number of times each basis symmetry needs to be applied to a given state to obtain its representative.</p>
</dd>
<dt><strong>return_sign</strong><span class="classifier">bool, optional</span></dt><dd><p>if set to <cite>True</cite>, the function returns the <cite>sign</cite> of the representative relative to the original state (nontrivial only for fermionic bases).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>tuple</dt><dd><p>( representatives, g_array, sign_array )
* array_like(int): <cite>representatives</cite>: Representatives under <cite>basis</cite> symmetries, corresponding to <cite>states</cite>.
* array_like(int): <cite>g_array</cite> of size (number of states, number of symmetries). Requires <cite>return_g=True</cite>. Contains integers corresponding to the number of times each basis symmetry needs to be applied to a given state to obtain its representative.
* array_like(int): <cite>sign_array</cite> of size (number of states,). Requires <cite>return_sign=True</cite>. Contains <cite>sign</cite> of the representative relative to the original state (nontrivial only for fermionic bases).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">basis</span><span class="o">=</span><span class="n">spin_basis_general</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Nup</span><span class="o">=</span><span class="n">Nup</span><span class="p">,</span><span class="n">make_basis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="mi">17</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">representative</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.sps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sps</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.sps" title="Link to this definition"></a></dt>
<dd><p>number of states per site (ie, the on-site Hilbert space dimension).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.state_to_int">
<span class="sig-name descname"><span class="pre">state_to_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/basis/basis_general/fermion.html#spinful_fermion_basis_general.state_to_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.state_to_int" title="Link to this definition"></a></dt>
<dd><p>Finds integer representation of a state defined in string format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>state</strong><span class="classifier">str</span></dt><dd><p>Defines the Fock state with number of particles (spins) per site in underlying lattice <cite>basis</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>int</dt><dd><p>Integer corresponding to the Fock <cite>state</cite> in the lattice basis.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is the einverse of <cite>int_to_state</cite>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s_str</span> <span class="o">=</span> <span class="s2">&quot;111000&quot;</span> <span class="c1"># pick state from basis set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">basis</span><span class="o">.</span><span class="n">state_to_int</span><span class="p">(</span><span class="n">s_str</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="quspin.basis.spinful_fermion_basis_general.states">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">states</span></span><a class="headerlink" href="#quspin.basis.spinful_fermion_basis_general.states" title="Link to this definition"></a></dt>
<dd><p>basis states stored in their integer representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray(int)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quspin.basis.spinless_fermion_basis_general.html" class="btn btn-neutral float-left" title="quspin.basis.spinless_fermion_basis_general" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="quspin.basis.user_basis.html" class="btn btn-neutral float-right" title="quspin.basis.user_basis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, Phillip Weinberg, Markus Schmitt, and Marin Bukov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6885KZ7NH6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6885KZ7NH6', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>