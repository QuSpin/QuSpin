<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>quspin.tools.lanczos.LTLM_static_iteration &mdash; QuSpin 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../static/css/sphinx_rtd_size.css?v=f26ae176" />
      <link rel="stylesheet" type="text/css" href="../static/css/py_class_property_fix.css?v=faf79ccd" />

  
  <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../static/jquery.js?v=5d32c60e"></script>
        <script src="../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../static/documentation_options.js?v=292eb321"></script>
        <script src="../static/doctools.js?v=9a2dae69"></script>
        <script src="../static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="quspin.tools.lanczos.FTLM_static_iteration" href="quspin.tools.lanczos.FTLM_static_iteration.html" />
    <link rel="prev" title="quspin.tools.lanczos.lin_comb_Q_T" href="quspin.tools.lanczos.lin_comb_Q_T.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            QuSpin
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">New Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../new_features.html">Highlights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../new_features.html#most-recent-changes-features">Most recent changes &amp; features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">QuSpin (public API)</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../basis.html">Basis module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.basis</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operators.html">Operators module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.operators</span></code>)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tools.html">Tools module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.tools</span></code>)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tools.html#evolution">evolution</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tools.html#lanczos">Lanczos</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quspin.tools.lanczos.lanczos_full.html">quspin.tools.lanczos.lanczos_full</a></li>
<li class="toctree-l3"><a class="reference internal" href="quspin.tools.lanczos.lanczos_iter.html">quspin.tools.lanczos.lanczos_iter</a></li>
<li class="toctree-l3"><a class="reference internal" href="quspin.tools.lanczos.expm_lanczos.html">quspin.tools.lanczos.expm_lanczos</a></li>
<li class="toctree-l3"><a class="reference internal" href="quspin.tools.lanczos.lin_comb_Q_T.html">quspin.tools.lanczos.lin_comb_Q_T</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">quspin.tools.lanczos.LTLM_static_iteration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quspin.tools.lanczos.LTLM_static_iteration"><code class="docutils literal notranslate"><span class="pre">LTLM_static_iteration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="quspin.tools.lanczos.FTLM_static_iteration.html">quspin.tools.lanczos.FTLM_static_iteration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools.html#floquet">Floquet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools.html#measurements">measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools.html#block-tools">block_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tools.html#misc">misc</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation &amp; Use</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html#basics-of-command-line-use">Basics of command line use</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../example_scripts.html">Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter_notebooks.html">Jupyter notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/parallelization.html">Parallel computing support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/user_basis.html"><cite>user_basis</cite> tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Bugs &amp; Questions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute/report_a_bug.html">Report a bug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/ask_a_question.html">Ask a question</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuSpin</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tools.html">Tools module (<code class="xref py py-mod docutils literal notranslate"><span class="pre">quspin.tools</span></code>)</a></li>
      <li class="breadcrumb-item active">quspin.tools.lanczos.LTLM_static_iteration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../sources/generated/quspin.tools.lanczos.LTLM_static_iteration.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style> .red {color:#ff0000; font-weight:bold; font-style:italic; } </style>
<style> .green {color:#00b200; font-weight:bold; font-style:italic; } </style>
<style> .magenta {color:#FF33F3; font-weight:bold; font-style:italic; } </style>
<style> .orange {color:#FE8E02; font-weight:bold; font-style:italic; } </style><section id="quspin-tools-lanczos-ltlm-static-iteration">
<h1>quspin.tools.lanczos.LTLM_static_iteration<a class="headerlink" href="#quspin-tools-lanczos-ltlm-static-iteration" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="quspin.tools.lanczos.LTLM_static_iteration">
<span class="sig-prename descclassname"><span class="pre">quspin.tools.lanczos.</span></span><span class="sig-name descname"><span class="pre">LTLM_static_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">O_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Q_T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../modules/quspin/tools/lanczos/_LTLM.html#LTLM_static_iteration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#quspin.tools.lanczos.LTLM_static_iteration" title="Link to this definition"></a></dt>
<dd><p>Calculate iteration for low-temperature Lanczos method.</p>
<p>Here we give a brief overview of this method based on <a class="reference external" href="https://arxiv.org/abs/1111.5931">arXiv:1111.5931</a>.</p>
<p>One would naively think that it would require full diagonalization to calculate thermodynamic expectation values
for a quantum system as one has to fully diagonalize the Hamiltonian to evaluate:</p>
<div class="math notranslate nohighlight">
\[\langle O\rangle_\beta = \frac{1}{Z}Tr\left(e^{-\beta H}O\right)\]</div>
<p>with the partition function defined as: <span class="math notranslate nohighlight">\(Z=Tr\left(e^{-\beta H}\right)\)</span>. The idea behind the
Low-Temperature Lanczos Method (LTLM) is to use quantum typicality as well as Krylov subspaces to
simplify this calculation. Typicality states that the trace of an operator can be approximated as an average
of that same operator with random vectors in the Hilbert-space sampled with the Harr measure. As a corollary, it
is known that the fluctuations of this average for any finite sample set will converge to 0 as the size of
the Hilbert space increases. Mathematically this is expressed as:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\dim\mathcal{H}}Tr\left(e^{-\beta H}O\right)\approx \frac{1}{N_r}\sum_r\langle r| e^{-\beta H}O |r\rangle\]</div>
<p>where <span class="math notranslate nohighlight">\(|r\rangle\)</span> is a random state from the Harr measure of hilbert space <span class="math notranslate nohighlight">\(\mathcal{H}\)</span> if the
Hamiltonian. An issue can occur when the temperature goes to zero as the overlap <span class="math notranslate nohighlight">\(\langle r| e^{-\beta H}O |r\rangle\)</span> will
be quite small for most states <span class="math notranslate nohighlight">\(|r\rangle\)</span>. Hence, this will require more random realizations to converge.
Fortunately the trace is cyclical and therefore we can make the expression more symmetric:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\dim\mathcal{H}}Tr\left(e^{-\beta H}O\right)=\frac{1}{\dim\mathcal{H}}Tr\left(e^{-\beta H/2}O e^{-\beta H/2}\right)\approx \frac{1}{N_r}\sum_r\langle r|e^{-\beta H/2}O e^{-\beta H/2}|r\rangle\]</div>
<p>Such that the expecation value is exact as <span class="math notranslate nohighlight">\(\beta\rightarrow\infty\)</span> at the cost of having to calculate
two matrix exponentials. Next we can approximate the matrix exponential using the Lanczos basis. The idea
is that the eigenstates from the lanczos basis can effectively be inserted as an identity operator:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{\dim\mathcal{H}}Tr\left(e^{-\beta H/2}O e^{-\beta H/2}\right)\approx \frac{1}{N_r}\sum_r\langle r|e^{-\beta H/2}O e^{-\beta H/2}|r\rangle\approx \frac{1}{N_r}\sum_r\sum_{i,j=1}^m e^{-\beta(\epsilon^{(r)}_i+\epsilon^{(r)}_j)/2}\langle r|\psi^{(r)}_i\rangle\langle\psi^{(r)}_i|O|\psi^{(r)}_j\rangle\langle\psi^{(r)}_j|r\rangle = \frac{1}{N_r}\sum_r \langle O\rangle_r \equiv \overline{\langle O\rangle_r}\]</div>
<p>Now going back to the thermal expecation value, we can use the expression above to calculate <span class="math notranslate nohighlight">\(\frac{1}{Z}Tr\left(e^{-\beta H}O\right)\)</span>
by noting that the partition function is simply the expecation value of the identity operator: <span class="math notranslate nohighlight">\(Z=Tr\left(e^{-\beta H}I\right)\)</span> and hence
the thermal expecation value is approximated by:</p>
<div class="math notranslate nohighlight">
\[\langle O\rangle_\beta \approx \frac{\overline{\langle O\rangle_r}}{\overline{\langle I\rangle_r}}\]</div>
<p>The idea behind this function is to generate the the expecation value <span class="math notranslate nohighlight">\(\langle O\rangle_r\)</span> and <span class="math notranslate nohighlight">\(\langle I\rangle_r\)</span>
for a lanczos basis generated from an initial state <span class="math notranslate nohighlight">\(|r\rangle\)</span>. Therefore if the user would like to calculate the thermal expecation value all one
has to do call this function for each lanczos basis generated from a random state <span class="math notranslate nohighlight">\(|r\rangle\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>O_dict</strong><span class="classifier">dictionary of Python Objects</span></dt><dd><p>These Objects must have a ‘dot’ method that calculates a matrix vector product on a numpy.ndarray[:], the effective shape of these objects should be (n,n).</p>
</dd>
<dt><strong>E</strong><span class="classifier">array_like, (m,)</span></dt><dd><p>Eigenvalues for the Krylov projection of some operator.</p>
</dd>
<dt><strong>V</strong><span class="classifier">array_like, (m,m)</span></dt><dd><p>Eigenvectors for the Krylov projection of some operator.</p>
</dd>
<dt><strong>Q_T</strong><span class="classifier">iterator over rows of Q_T</span></dt><dd><p>generator or ndarray that contains the lanczos basis associated with E, and V.</p>
</dd>
<dt><strong>beta</strong><span class="classifier">scalar/array_like, any shape</span></dt><dd><p>Inverse temperature values to evaluate.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Result_dict: dictionary</dt><dd><p>A dictionary storying the results for a single iteration of the LTLM. The results are stored in numpy.ndarrays
that have the same shape as <cite>beta</cite>. The keys of <cite>Result_dict</cite> are the same as the keys in <cite>O_dict</cite> and the values
associated with the given key in <cite>Result_dict</cite> are the expectation values for the operator in <cite>O_dict</cite> with the same key.</p>
</dd>
<dt>I_expt: numpy.ndarray, same shape as <cite>beta</cite></dt><dd><p>The expecation value of the identity operator for each beta.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The amount of memory used by this function scales like: <span class="math notranslate nohighlight">\(nN_{op}\)</span> with <span class="math notranslate nohighlight">\(n\)</span> being the size of the full Hilbert space and <span class="math notranslate nohighlight">\(N_{op}\)</span> is the number of input operators.</p></li>
<li><p>LTLM converges equally well for low and high temperatures however it is more expensive compared to the FTLM and hence we recomend that one should use that method when dealing with high temperatures.</p></li>
<li><p>One has to be careful as typicality only applies to the trace operation over the entire Hilbert space. Using symmetries is possible, however it requires the user to keep track of the weights in the different sectors.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">Q_T</span> <span class="o">=</span> <span class="n">lanczos_full</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Res</span><span class="p">,</span><span class="n">Id</span> <span class="o">=</span> <span class="n">FTLM_static_iteration</span><span class="p">(</span><span class="n">Obs_dict</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Q_T</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quspin.tools.lanczos.lin_comb_Q_T.html" class="btn btn-neutral float-left" title="quspin.tools.lanczos.lin_comb_Q_T" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="quspin.tools.lanczos.FTLM_static_iteration.html" class="btn btn-neutral float-right" title="quspin.tools.lanczos.FTLM_static_iteration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Phillip Weinberg, Markus Schmitt, and Marin Bukov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6885KZ7NH6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6885KZ7NH6', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>